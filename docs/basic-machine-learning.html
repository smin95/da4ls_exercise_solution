<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 9 Basic Machine Learning | Data Analysis for the Life Sciences with R: Exercise Solutions</title>
  <meta name="description" content="Chapter 9 Basic Machine Learning | Data Analysis for the Life Sciences with R: Exercise Solutions" />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 9 Basic Machine Learning | Data Analysis for the Life Sciences with R: Exercise Solutions" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 9 Basic Machine Learning | Data Analysis for the Life Sciences with R: Exercise Solutions" />
  
  
  

<meta name="author" content="Seung Hyun (Sam) Min" />


<meta name="date" content="2021-05-22" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="distance-and-dimension-reduction.html"/>
<link rel="next" href="batch-effects.html"/>
<script src="libs/header-attrs-2.7/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">DA4LS with R: Exercise Solutions</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome!</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#acknowledgment"><i class="fa fa-check"></i>Acknowledgment</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#frequently-asked-questions"><i class="fa fa-check"></i>Frequently Asked Questions</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#contribution"><i class="fa fa-check"></i>Contribution</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#license"><i class="fa fa-check"></i>License</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#etc"><i class="fa fa-check"></i>Etc</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="getting-started.html"><a href="getting-started.html"><i class="fa fa-check"></i><b>1</b> Getting started</a>
<ul>
<li class="chapter" data-level="" data-path="getting-started.html"><a href="getting-started.html#before-reading-da4ls-with-r"><i class="fa fa-check"></i>Before reading DA4LS with R</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="inference.html"><a href="inference.html"><i class="fa fa-check"></i><b>2</b> Inference</a>
<ul>
<li class="chapter" data-level="" data-path="inference.html"><a href="inference.html#exercises"><i class="fa fa-check"></i>2.7 Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="inference.html"><a href="inference.html#question-1"><i class="fa fa-check"></i>Question 1</a></li>
<li class="chapter" data-level="" data-path="inference.html"><a href="inference.html#question-2"><i class="fa fa-check"></i>Question 2</a></li>
<li class="chapter" data-level="" data-path="inference.html"><a href="inference.html#question-3"><i class="fa fa-check"></i>Question 3</a></li>
<li class="chapter" data-level="" data-path="inference.html"><a href="inference.html#question-4"><i class="fa fa-check"></i>Question 4</a></li>
<li class="chapter" data-level="" data-path="inference.html"><a href="inference.html#question-5"><i class="fa fa-check"></i>Question 5</a></li>
<li class="chapter" data-level="" data-path="inference.html"><a href="inference.html#question-6"><i class="fa fa-check"></i>Question 6</a></li>
<li class="chapter" data-level="" data-path="inference.html"><a href="inference.html#question-7"><i class="fa fa-check"></i>Question 7</a></li>
<li class="chapter" data-level="" data-path="inference.html"><a href="inference.html#question-8"><i class="fa fa-check"></i>Question 8</a></li>
<li class="chapter" data-level="" data-path="inference.html"><a href="inference.html#question-9"><i class="fa fa-check"></i>Question 9</a></li>
<li class="chapter" data-level="" data-path="inference.html"><a href="inference.html#question-10"><i class="fa fa-check"></i>Question 10</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="inference.html"><a href="inference.html#exercises-1"><i class="fa fa-check"></i>2.9 Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="inference.html"><a href="inference.html#question-1-1"><i class="fa fa-check"></i>Question 1</a></li>
<li class="chapter" data-level="" data-path="inference.html"><a href="inference.html#question-2-1"><i class="fa fa-check"></i>Question 2</a></li>
<li class="chapter" data-level="" data-path="inference.html"><a href="inference.html#question-3-1"><i class="fa fa-check"></i>Question 3</a></li>
<li class="chapter" data-level="" data-path="inference.html"><a href="inference.html#question-4-1"><i class="fa fa-check"></i>Question 4</a></li>
<li class="chapter" data-level="" data-path="inference.html"><a href="inference.html#question-5-1"><i class="fa fa-check"></i>Question 5</a></li>
<li class="chapter" data-level="" data-path="inference.html"><a href="inference.html#question-6-1"><i class="fa fa-check"></i>Question 6</a></li>
<li class="chapter" data-level="" data-path="inference.html"><a href="inference.html#question-7-1"><i class="fa fa-check"></i>Question 7</a></li>
<li class="chapter" data-level="" data-path="inference.html"><a href="inference.html#question-8-1"><i class="fa fa-check"></i>Question 8</a></li>
<li class="chapter" data-level="" data-path="inference.html"><a href="inference.html#question-9-1"><i class="fa fa-check"></i>Question 9</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="inference.html"><a href="inference.html#exercises-2"><i class="fa fa-check"></i>2.11 Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="inference.html"><a href="inference.html#question-1-2"><i class="fa fa-check"></i>Question 1</a></li>
<li class="chapter" data-level="" data-path="inference.html"><a href="inference.html#question-2-2"><i class="fa fa-check"></i>Question 2</a></li>
<li class="chapter" data-level="" data-path="inference.html"><a href="inference.html#question-3-2"><i class="fa fa-check"></i>Question 3</a></li>
<li class="chapter" data-level="" data-path="inference.html"><a href="inference.html#question-4-2"><i class="fa fa-check"></i>Question 4</a></li>
<li class="chapter" data-level="" data-path="inference.html"><a href="inference.html#question-5-2"><i class="fa fa-check"></i>Question 5</a></li>
<li class="chapter" data-level="" data-path="inference.html"><a href="inference.html#question-6-2"><i class="fa fa-check"></i>Question 6</a></li>
<li class="chapter" data-level="" data-path="inference.html"><a href="inference.html#question-7-2"><i class="fa fa-check"></i>Question 7</a></li>
<li class="chapter" data-level="" data-path="inference.html"><a href="inference.html#question-8-2"><i class="fa fa-check"></i>Question 8</a></li>
<li class="chapter" data-level="" data-path="inference.html"><a href="inference.html#question-9-2"><i class="fa fa-check"></i>Question 9</a></li>
<li class="chapter" data-level="" data-path="inference.html"><a href="inference.html#question-10-1"><i class="fa fa-check"></i>Question 10</a></li>
<li class="chapter" data-level="" data-path="inference.html"><a href="inference.html#question-11"><i class="fa fa-check"></i>Question 11</a></li>
<li class="chapter" data-level="" data-path="inference.html"><a href="inference.html#question-12"><i class="fa fa-check"></i>Question 12</a></li>
<li class="chapter" data-level="" data-path="inference.html"><a href="inference.html#question-13"><i class="fa fa-check"></i>Question 13</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="inference.html"><a href="inference.html#exercises-3"><i class="fa fa-check"></i>2.13 Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="inference.html"><a href="inference.html#question-1-3"><i class="fa fa-check"></i>Question 1</a></li>
<li class="chapter" data-level="" data-path="inference.html"><a href="inference.html#question-2-3"><i class="fa fa-check"></i>Question 2</a></li>
<li class="chapter" data-level="" data-path="inference.html"><a href="inference.html#question-3-3"><i class="fa fa-check"></i>Question 3</a></li>
<li class="chapter" data-level="" data-path="inference.html"><a href="inference.html#question-4-3"><i class="fa fa-check"></i>Question 4</a></li>
<li class="chapter" data-level="" data-path="inference.html"><a href="inference.html#question-5-3"><i class="fa fa-check"></i>Question 5</a></li>
<li class="chapter" data-level="" data-path="inference.html"><a href="inference.html#question-6-3"><i class="fa fa-check"></i>Question 6</a></li>
<li class="chapter" data-level="" data-path="inference.html"><a href="inference.html#question-7-3"><i class="fa fa-check"></i>Question 7</a></li>
<li class="chapter" data-level="" data-path="inference.html"><a href="inference.html#question-8-3"><i class="fa fa-check"></i>Question 8</a></li>
<li class="chapter" data-level="" data-path="inference.html"><a href="inference.html#question-9-3"><i class="fa fa-check"></i>Question 9</a></li>
<li class="chapter" data-level="" data-path="inference.html"><a href="inference.html#question-10-2"><i class="fa fa-check"></i>Question 10</a></li>
<li class="chapter" data-level="" data-path="inference.html"><a href="inference.html#question-11-1"><i class="fa fa-check"></i>Question 11</a></li>
<li class="chapter" data-level="" data-path="inference.html"><a href="inference.html#question-12-1"><i class="fa fa-check"></i>Question 12</a></li>
<li class="chapter" data-level="" data-path="inference.html"><a href="inference.html#question-13-1"><i class="fa fa-check"></i>Question 13</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="inference.html"><a href="inference.html#exercises-4"><i class="fa fa-check"></i>2.18 Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="inference.html"><a href="inference.html#question-1-4"><i class="fa fa-check"></i>Question 1</a></li>
<li class="chapter" data-level="" data-path="inference.html"><a href="inference.html#question-2-4"><i class="fa fa-check"></i>Question 2</a></li>
<li class="chapter" data-level="" data-path="inference.html"><a href="inference.html#question-3-4"><i class="fa fa-check"></i>Question 3</a></li>
<li class="chapter" data-level="" data-path="inference.html"><a href="inference.html#question-4-4"><i class="fa fa-check"></i>Question 4</a></li>
<li class="chapter" data-level="" data-path="inference.html"><a href="inference.html#question-5-4"><i class="fa fa-check"></i>Question 5</a></li>
<li class="chapter" data-level="" data-path="inference.html"><a href="inference.html#question-6-4"><i class="fa fa-check"></i>Question 6</a></li>
<li class="chapter" data-level="" data-path="inference.html"><a href="inference.html#question-7-4"><i class="fa fa-check"></i>Question 7</a></li>
<li class="chapter" data-level="" data-path="inference.html"><a href="inference.html#question-8-4"><i class="fa fa-check"></i>Question 8</a></li>
<li class="chapter" data-level="" data-path="inference.html"><a href="inference.html#question-9-4"><i class="fa fa-check"></i>Question 9</a></li>
<li class="chapter" data-level="" data-path="inference.html"><a href="inference.html#question-10-3"><i class="fa fa-check"></i>Question 10</a></li>
<li class="chapter" data-level="" data-path="inference.html"><a href="inference.html#question-11-2"><i class="fa fa-check"></i>Question 11</a></li>
<li class="chapter" data-level="" data-path="inference.html"><a href="inference.html#question-12-2"><i class="fa fa-check"></i>Question 12</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="inference.html"><a href="inference.html#exercises-5"><i class="fa fa-check"></i>2.21 Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="inference.html"><a href="inference.html#question-1-5"><i class="fa fa-check"></i>Question 1</a></li>
<li class="chapter" data-level="" data-path="inference.html"><a href="inference.html#question-2-5"><i class="fa fa-check"></i>Question 2</a></li>
<li class="chapter" data-level="" data-path="inference.html"><a href="inference.html#question-3-5"><i class="fa fa-check"></i>Question 3</a></li>
<li class="chapter" data-level="" data-path="inference.html"><a href="inference.html#question-4-5"><i class="fa fa-check"></i>Question 4</a></li>
<li class="chapter" data-level="" data-path="inference.html"><a href="inference.html#question-5-5"><i class="fa fa-check"></i>Question 5</a></li>
<li class="chapter" data-level="" data-path="inference.html"><a href="inference.html#question-6-5"><i class="fa fa-check"></i>Question 6</a></li>
<li class="chapter" data-level="" data-path="inference.html"><a href="inference.html#question-7-5"><i class="fa fa-check"></i>Question 7</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="inference.html"><a href="inference.html#exercises-6"><i class="fa fa-check"></i>2.23 Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="inference.html"><a href="inference.html#question-1-6"><i class="fa fa-check"></i>Question 1</a></li>
<li class="chapter" data-level="" data-path="inference.html"><a href="inference.html#question-2-6"><i class="fa fa-check"></i>Question 2</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="inference.html"><a href="inference.html#exercises-7"><i class="fa fa-check"></i>2.25 Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="inference.html"><a href="inference.html#question-1-7"><i class="fa fa-check"></i>Question 1</a></li>
<li class="chapter" data-level="" data-path="inference.html"><a href="inference.html#question-2-7"><i class="fa fa-check"></i>Question 2</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html"><i class="fa fa-check"></i><b>3</b> Exploratory Data Analysis</a>
<ul>
<li class="chapter" data-level="" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#exercises-8"><i class="fa fa-check"></i>3.8 Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#question-1-8"><i class="fa fa-check"></i>Question 1</a></li>
<li class="chapter" data-level="" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#question-2-8"><i class="fa fa-check"></i>Question 2</a></li>
<li class="chapter" data-level="" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#question-3-6"><i class="fa fa-check"></i>Question 3</a></li>
<li class="chapter" data-level="" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#question-4-6"><i class="fa fa-check"></i>Question 4</a></li>
<li class="chapter" data-level="" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#question-5-6"><i class="fa fa-check"></i>Question 5</a></li>
<li class="chapter" data-level="" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#question-6-6"><i class="fa fa-check"></i>Question 6</a></li>
<li class="chapter" data-level="" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#question-7-6"><i class="fa fa-check"></i>Question 7</a></li>
<li class="chapter" data-level="" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#question-8-5"><i class="fa fa-check"></i>Question 8</a></li>
<li class="chapter" data-level="" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#question-9-5"><i class="fa fa-check"></i>Question 9</a></li>
<li class="chapter" data-level="" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#question-10-4"><i class="fa fa-check"></i>Question 10</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#exercises-9"><i class="fa fa-check"></i>3.11 Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#question-1-9"><i class="fa fa-check"></i>Question 1</a></li>
<li class="chapter" data-level="" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#question-2-9"><i class="fa fa-check"></i>Question 2</a></li>
<li class="chapter" data-level="" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#question-3-7"><i class="fa fa-check"></i>Question 3</a></li>
<li class="chapter" data-level="" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#question-4-7"><i class="fa fa-check"></i>Question 4</a></li>
<li class="chapter" data-level="" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#question-5-7"><i class="fa fa-check"></i>Question 5</a></li>
<li class="chapter" data-level="" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#question-6-7"><i class="fa fa-check"></i>Question 6</a></li>
<li class="chapter" data-level="" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#question-7-7"><i class="fa fa-check"></i>Question 7</a></li>
<li class="chapter" data-level="" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#question-8-6"><i class="fa fa-check"></i>Question 8</a></li>
<li class="chapter" data-level="" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#question-9-6"><i class="fa fa-check"></i>Question 9</a></li>
<li class="chapter" data-level="" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#question-10-5"><i class="fa fa-check"></i>Question 10</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="matrix-algebra.html"><a href="matrix-algebra.html"><i class="fa fa-check"></i><b>4</b> Matrix Algebra</a>
<ul>
<li class="chapter" data-level="" data-path="matrix-algebra.html"><a href="matrix-algebra.html#exercises-10"><i class="fa fa-check"></i>4.2 Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="matrix-algebra.html"><a href="matrix-algebra.html#question-1-10"><i class="fa fa-check"></i>Question 1</a></li>
<li class="chapter" data-level="" data-path="matrix-algebra.html"><a href="matrix-algebra.html#question-2-10"><i class="fa fa-check"></i>Question 2</a></li>
<li class="chapter" data-level="" data-path="matrix-algebra.html"><a href="matrix-algebra.html#question-3-8"><i class="fa fa-check"></i>Question 3</a></li>
<li class="chapter" data-level="" data-path="matrix-algebra.html"><a href="matrix-algebra.html#question-4-8"><i class="fa fa-check"></i>Question 4</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="matrix-algebra.html"><a href="matrix-algebra.html#exercises-11"><i class="fa fa-check"></i>4.6 Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="matrix-algebra.html"><a href="matrix-algebra.html#question-1-11"><i class="fa fa-check"></i>Question 1</a></li>
<li class="chapter" data-level="" data-path="matrix-algebra.html"><a href="matrix-algebra.html#question-2-11"><i class="fa fa-check"></i>Question 2</a></li>
<li class="chapter" data-level="" data-path="matrix-algebra.html"><a href="matrix-algebra.html#question-3-9"><i class="fa fa-check"></i>Question 3</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="matrix-algebra.html"><a href="matrix-algebra.html#exercises-12"><i class="fa fa-check"></i>4.8 Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="matrix-algebra.html"><a href="matrix-algebra.html#question-1-12"><i class="fa fa-check"></i>Question 1</a></li>
<li class="chapter" data-level="" data-path="matrix-algebra.html"><a href="matrix-algebra.html#question-2-12"><i class="fa fa-check"></i>Question 2</a></li>
<li class="chapter" data-level="" data-path="matrix-algebra.html"><a href="matrix-algebra.html#question-3-10"><i class="fa fa-check"></i>Question 3</a></li>
<li class="chapter" data-level="" data-path="matrix-algebra.html"><a href="matrix-algebra.html#question-4-9"><i class="fa fa-check"></i>Question 4</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="matrix-algebra.html"><a href="matrix-algebra.html#exercises-13"><i class="fa fa-check"></i>4.10 Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="matrix-algebra.html"><a href="matrix-algebra.html#question-1-13"><i class="fa fa-check"></i>Question 1</a></li>
<li class="chapter" data-level="" data-path="matrix-algebra.html"><a href="matrix-algebra.html#question-2-13"><i class="fa fa-check"></i>Question 2</a></li>
<li class="chapter" data-level="" data-path="matrix-algebra.html"><a href="matrix-algebra.html#question-3-11"><i class="fa fa-check"></i>Question 3</a></li>
<li class="chapter" data-level="" data-path="matrix-algebra.html"><a href="matrix-algebra.html#question-4-10"><i class="fa fa-check"></i>Question 4</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="linear-models.html"><a href="linear-models.html"><i class="fa fa-check"></i><b>5</b> Linear Models</a>
<ul>
<li class="chapter" data-level="" data-path="linear-models.html"><a href="linear-models.html#exercises-14"><i class="fa fa-check"></i>5.1 Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="linear-models.html"><a href="linear-models.html#question-1-14"><i class="fa fa-check"></i>Question 1</a></li>
<li class="chapter" data-level="" data-path="linear-models.html"><a href="linear-models.html#question-2-14"><i class="fa fa-check"></i>Question 2</a></li>
<li class="chapter" data-level="" data-path="linear-models.html"><a href="linear-models.html#question-3-12"><i class="fa fa-check"></i>Question 3</a></li>
<li class="chapter" data-level="" data-path="linear-models.html"><a href="linear-models.html#question-4-11"><i class="fa fa-check"></i>Question 4</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="linear-models.html"><a href="linear-models.html#exercises-15"><i class="fa fa-check"></i>5.3 Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="linear-models.html"><a href="linear-models.html#question-1-15"><i class="fa fa-check"></i>Question 1</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="linear-models.html"><a href="linear-models.html#exercises-16"><i class="fa fa-check"></i>5.5 Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="linear-models.html"><a href="linear-models.html#question-1-16"><i class="fa fa-check"></i>Question 1</a></li>
<li class="chapter" data-level="" data-path="linear-models.html"><a href="linear-models.html#question-2-15"><i class="fa fa-check"></i>Question 2</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="linear-models.html"><a href="linear-models.html#exercises-17"><i class="fa fa-check"></i>5.7 Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="linear-models.html"><a href="linear-models.html#question-1-17"><i class="fa fa-check"></i>Question 1</a></li>
<li class="chapter" data-level="" data-path="linear-models.html"><a href="linear-models.html#question-2-16"><i class="fa fa-check"></i>Question 2</a></li>
<li class="chapter" data-level="" data-path="linear-models.html"><a href="linear-models.html#question-3-13"><i class="fa fa-check"></i>Question 3</a></li>
<li class="chapter" data-level="" data-path="linear-models.html"><a href="linear-models.html#question-4-12"><i class="fa fa-check"></i>Question 4</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="linear-models.html"><a href="linear-models.html#exercises-18"><i class="fa fa-check"></i>5.11 Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="linear-models.html"><a href="linear-models.html#question-1-18"><i class="fa fa-check"></i>Question 1</a></li>
<li class="chapter" data-level="" data-path="linear-models.html"><a href="linear-models.html#question-2-17"><i class="fa fa-check"></i>Question 2</a></li>
<li class="chapter" data-level="" data-path="linear-models.html"><a href="linear-models.html#question-3-14"><i class="fa fa-check"></i>Question 3</a></li>
<li class="chapter" data-level="" data-path="linear-models.html"><a href="linear-models.html#question-4-13"><i class="fa fa-check"></i>Question 4</a></li>
<li class="chapter" data-level="" data-path="linear-models.html"><a href="linear-models.html#question-5-8"><i class="fa fa-check"></i>Question 5</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="linear-models.html"><a href="linear-models.html#exercises-19"><i class="fa fa-check"></i>5.15 Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="linear-models.html"><a href="linear-models.html#question-1-19"><i class="fa fa-check"></i>Question 1</a></li>
<li class="chapter" data-level="" data-path="linear-models.html"><a href="linear-models.html#question-2-18"><i class="fa fa-check"></i>Question 2</a></li>
<li class="chapter" data-level="" data-path="linear-models.html"><a href="linear-models.html#question-3-15"><i class="fa fa-check"></i>Question 3</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="inference-for-high-dimensional-data.html"><a href="inference-for-high-dimensional-data.html"><i class="fa fa-check"></i><b>6</b> Inference for High Dimensional Data</a>
<ul>
<li class="chapter" data-level="" data-path="inference-for-high-dimensional-data.html"><a href="inference-for-high-dimensional-data.html#exercises-20"><i class="fa fa-check"></i>6.2 Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="inference-for-high-dimensional-data.html"><a href="inference-for-high-dimensional-data.html#question-1-20"><i class="fa fa-check"></i>Question 1</a></li>
<li class="chapter" data-level="" data-path="inference-for-high-dimensional-data.html"><a href="inference-for-high-dimensional-data.html#questions-2"><i class="fa fa-check"></i>Questions 2</a></li>
<li class="chapter" data-level="" data-path="inference-for-high-dimensional-data.html"><a href="inference-for-high-dimensional-data.html#question-3-16"><i class="fa fa-check"></i>Question 3</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="inference-for-high-dimensional-data.html"><a href="inference-for-high-dimensional-data.html#exercises-21"><i class="fa fa-check"></i>6.4 Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="inference-for-high-dimensional-data.html"><a href="inference-for-high-dimensional-data.html#question-1-21"><i class="fa fa-check"></i>Question 1</a></li>
<li class="chapter" data-level="" data-path="inference-for-high-dimensional-data.html"><a href="inference-for-high-dimensional-data.html#question-2-19"><i class="fa fa-check"></i>Question 2</a></li>
<li class="chapter" data-level="" data-path="inference-for-high-dimensional-data.html"><a href="inference-for-high-dimensional-data.html#question-3-17"><i class="fa fa-check"></i>Question 3</a></li>
<li class="chapter" data-level="" data-path="inference-for-high-dimensional-data.html"><a href="inference-for-high-dimensional-data.html#question-4-14"><i class="fa fa-check"></i>Question 4</a></li>
<li class="chapter" data-level="" data-path="inference-for-high-dimensional-data.html"><a href="inference-for-high-dimensional-data.html#question-5-9"><i class="fa fa-check"></i>Question 5</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="inference-for-high-dimensional-data.html"><a href="inference-for-high-dimensional-data.html#exercises-22"><i class="fa fa-check"></i>6.10 Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="inference-for-high-dimensional-data.html"><a href="inference-for-high-dimensional-data.html#question-1-22"><i class="fa fa-check"></i>Question 1</a></li>
<li class="chapter" data-level="" data-path="inference-for-high-dimensional-data.html"><a href="inference-for-high-dimensional-data.html#question-2-20"><i class="fa fa-check"></i>Question 2</a></li>
<li class="chapter" data-level="" data-path="inference-for-high-dimensional-data.html"><a href="inference-for-high-dimensional-data.html#question-3-18"><i class="fa fa-check"></i>Question 3</a></li>
<li class="chapter" data-level="" data-path="inference-for-high-dimensional-data.html"><a href="inference-for-high-dimensional-data.html#question-4-15"><i class="fa fa-check"></i>Question 4</a></li>
<li class="chapter" data-level="" data-path="inference-for-high-dimensional-data.html"><a href="inference-for-high-dimensional-data.html#question-5-10"><i class="fa fa-check"></i>Question 5</a></li>
<li class="chapter" data-level="" data-path="inference-for-high-dimensional-data.html"><a href="inference-for-high-dimensional-data.html#question-6-8"><i class="fa fa-check"></i>Question 6</a></li>
<li class="chapter" data-level="" data-path="inference-for-high-dimensional-data.html"><a href="inference-for-high-dimensional-data.html#question-7-8"><i class="fa fa-check"></i>Question 7</a></li>
<li class="chapter" data-level="" data-path="inference-for-high-dimensional-data.html"><a href="inference-for-high-dimensional-data.html#question-8-7"><i class="fa fa-check"></i>Question 8</a></li>
<li class="chapter" data-level="" data-path="inference-for-high-dimensional-data.html"><a href="inference-for-high-dimensional-data.html#question-9-7"><i class="fa fa-check"></i>Question 9</a></li>
<li class="chapter" data-level="" data-path="inference-for-high-dimensional-data.html"><a href="inference-for-high-dimensional-data.html#question-10-6"><i class="fa fa-check"></i>Question 10</a></li>
<li class="chapter" data-level="" data-path="inference-for-high-dimensional-data.html"><a href="inference-for-high-dimensional-data.html#question-11-3"><i class="fa fa-check"></i>Question 11</a></li>
<li class="chapter" data-level="" data-path="inference-for-high-dimensional-data.html"><a href="inference-for-high-dimensional-data.html#question-12-3"><i class="fa fa-check"></i>Question 12</a></li>
<li class="chapter" data-level="" data-path="inference-for-high-dimensional-data.html"><a href="inference-for-high-dimensional-data.html#questions-13-14"><i class="fa fa-check"></i>Questions 13 &amp; 14</a></li>
<li class="chapter" data-level="" data-path="inference-for-high-dimensional-data.html"><a href="inference-for-high-dimensional-data.html#questions-15-16"><i class="fa fa-check"></i>Questions 15 &amp; 16</a></li>
<li class="chapter" data-level="" data-path="inference-for-high-dimensional-data.html"><a href="inference-for-high-dimensional-data.html#questions-17-18"><i class="fa fa-check"></i>Questions 17 &amp; 18</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="inference-for-high-dimensional-data.html"><a href="inference-for-high-dimensional-data.html#exercises-23"><i class="fa fa-check"></i>6.12 Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="inference-for-high-dimensional-data.html"><a href="inference-for-high-dimensional-data.html#question-1-23"><i class="fa fa-check"></i>Question 1</a></li>
<li class="chapter" data-level="" data-path="inference-for-high-dimensional-data.html"><a href="inference-for-high-dimensional-data.html#question-2-21"><i class="fa fa-check"></i>Question 2</a></li>
<li class="chapter" data-level="" data-path="inference-for-high-dimensional-data.html"><a href="inference-for-high-dimensional-data.html#question-3-19"><i class="fa fa-check"></i>Question 3</a></li>
<li class="chapter" data-level="" data-path="inference-for-high-dimensional-data.html"><a href="inference-for-high-dimensional-data.html#question-4-16"><i class="fa fa-check"></i>Question 4</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="statistical-models.html"><a href="statistical-models.html"><i class="fa fa-check"></i><b>7</b> Statistical Models</a>
<ul>
<li class="chapter" data-level="" data-path="statistical-models.html"><a href="statistical-models.html#exercises-24"><i class="fa fa-check"></i>7.5 Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="statistical-models.html"><a href="statistical-models.html#question-1-24"><i class="fa fa-check"></i>Question 1</a></li>
<li class="chapter" data-level="" data-path="statistical-models.html"><a href="statistical-models.html#question-2-22"><i class="fa fa-check"></i>Question 2</a></li>
<li class="chapter" data-level="" data-path="statistical-models.html"><a href="statistical-models.html#question-3-20"><i class="fa fa-check"></i>Question 3</a></li>
<li class="chapter" data-level="" data-path="statistical-models.html"><a href="statistical-models.html#question-4-17"><i class="fa fa-check"></i>Question 4</a></li>
<li class="chapter" data-level="" data-path="statistical-models.html"><a href="statistical-models.html#question-5-11"><i class="fa fa-check"></i>Question 5</a></li>
<li class="chapter" data-level="" data-path="statistical-models.html"><a href="statistical-models.html#question-6-9"><i class="fa fa-check"></i>Question 6</a></li>
<li class="chapter" data-level="" data-path="statistical-models.html"><a href="statistical-models.html#question-7-9"><i class="fa fa-check"></i>Question 7</a></li>
<li class="chapter" data-level="" data-path="statistical-models.html"><a href="statistical-models.html#question-8-8"><i class="fa fa-check"></i>Question 8</a></li>
<li class="chapter" data-level="" data-path="statistical-models.html"><a href="statistical-models.html#question-9-8"><i class="fa fa-check"></i>Question 9</a></li>
<li class="chapter" data-level="" data-path="statistical-models.html"><a href="statistical-models.html#question-10-7"><i class="fa fa-check"></i>Question 10</a></li>
<li class="chapter" data-level="" data-path="statistical-models.html"><a href="statistical-models.html#question-11-4"><i class="fa fa-check"></i>Question 11</a></li>
<li class="chapter" data-level="" data-path="statistical-models.html"><a href="statistical-models.html#question-12-4"><i class="fa fa-check"></i>Question 12</a></li>
<li class="chapter" data-level="" data-path="statistical-models.html"><a href="statistical-models.html#question-13-2"><i class="fa fa-check"></i>Question 13</a></li>
<li class="chapter" data-level="" data-path="statistical-models.html"><a href="statistical-models.html#question-14"><i class="fa fa-check"></i>Question 14</a></li>
<li class="chapter" data-level="" data-path="statistical-models.html"><a href="statistical-models.html#question-15"><i class="fa fa-check"></i>Question 15</a></li>
<li class="chapter" data-level="" data-path="statistical-models.html"><a href="statistical-models.html#question-16"><i class="fa fa-check"></i>Question 16</a></li>
<li class="chapter" data-level="" data-path="statistical-models.html"><a href="statistical-models.html#question-17"><i class="fa fa-check"></i>Question 17</a></li>
<li class="chapter" data-level="" data-path="statistical-models.html"><a href="statistical-models.html#question-18"><i class="fa fa-check"></i>Question 18</a></li>
<li class="chapter" data-level="" data-path="statistical-models.html"><a href="statistical-models.html#question-19"><i class="fa fa-check"></i>Question 19</a></li>
<li class="chapter" data-level="" data-path="statistical-models.html"><a href="statistical-models.html#question-1-25"><i class="fa fa-check"></i>Question 1</a></li>
<li class="chapter" data-level="" data-path="statistical-models.html"><a href="statistical-models.html#question-2-23"><i class="fa fa-check"></i>Question 2</a></li>
<li class="chapter" data-level="" data-path="statistical-models.html"><a href="statistical-models.html#question-3-21"><i class="fa fa-check"></i>Question 3</a></li>
<li class="chapter" data-level="" data-path="statistical-models.html"><a href="statistical-models.html#question-4-18"><i class="fa fa-check"></i>Question 4</a></li>
<li class="chapter" data-level="" data-path="statistical-models.html"><a href="statistical-models.html#question-5-12"><i class="fa fa-check"></i>Question 5</a></li>
<li class="chapter" data-level="" data-path="statistical-models.html"><a href="statistical-models.html#question-6-10"><i class="fa fa-check"></i>Question 6</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="statistical-models.html"><a href="statistical-models.html#exericses"><i class="fa fa-check"></i>7.9 Exericses</a>
<ul>
<li class="chapter" data-level="" data-path="statistical-models.html"><a href="statistical-models.html#question-1-26"><i class="fa fa-check"></i>Question 1</a></li>
<li class="chapter" data-level="" data-path="statistical-models.html"><a href="statistical-models.html#question-2-24"><i class="fa fa-check"></i>Question 2</a></li>
<li class="chapter" data-level="" data-path="statistical-models.html"><a href="statistical-models.html#question-3-22"><i class="fa fa-check"></i>Question 3</a></li>
<li class="chapter" data-level="" data-path="statistical-models.html"><a href="statistical-models.html#question-4-19"><i class="fa fa-check"></i>Question 4</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="distance-and-dimension-reduction.html"><a href="distance-and-dimension-reduction.html"><i class="fa fa-check"></i><b>8</b> Distance and Dimension Reduction</a>
<ul>
<li class="chapter" data-level="" data-path="distance-and-dimension-reduction.html"><a href="distance-and-dimension-reduction.html#exercises-25"><i class="fa fa-check"></i>8.4 Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="distance-and-dimension-reduction.html"><a href="distance-and-dimension-reduction.html#question-1-27"><i class="fa fa-check"></i>Question 1</a></li>
<li class="chapter" data-level="" data-path="distance-and-dimension-reduction.html"><a href="distance-and-dimension-reduction.html#question-2-25"><i class="fa fa-check"></i>Question 2</a></li>
<li class="chapter" data-level="" data-path="distance-and-dimension-reduction.html"><a href="distance-and-dimension-reduction.html#question-3-23"><i class="fa fa-check"></i>Question 3</a></li>
<li class="chapter" data-level="" data-path="distance-and-dimension-reduction.html"><a href="distance-and-dimension-reduction.html#question-4-20"><i class="fa fa-check"></i>Question 4</a></li>
<li class="chapter" data-level="" data-path="distance-and-dimension-reduction.html"><a href="distance-and-dimension-reduction.html#question-5-13"><i class="fa fa-check"></i>Question 5</a></li>
<li class="chapter" data-level="" data-path="distance-and-dimension-reduction.html"><a href="distance-and-dimension-reduction.html#question-6-11"><i class="fa fa-check"></i>Question 6</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="distance-and-dimension-reduction.html"><a href="distance-and-dimension-reduction.html#exercises-26"><i class="fa fa-check"></i>8.7 Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="distance-and-dimension-reduction.html"><a href="distance-and-dimension-reduction.html#question-1-28"><i class="fa fa-check"></i>Question 1</a></li>
<li class="chapter" data-level="" data-path="distance-and-dimension-reduction.html"><a href="distance-and-dimension-reduction.html#question-2-26"><i class="fa fa-check"></i>Question 2</a></li>
<li class="chapter" data-level="" data-path="distance-and-dimension-reduction.html"><a href="distance-and-dimension-reduction.html#question-3-24"><i class="fa fa-check"></i>Question 3</a></li>
<li class="chapter" data-level="" data-path="distance-and-dimension-reduction.html"><a href="distance-and-dimension-reduction.html#question-4-21"><i class="fa fa-check"></i>Question 4</a></li>
<li class="chapter" data-level="" data-path="distance-and-dimension-reduction.html"><a href="distance-and-dimension-reduction.html#question-5-14"><i class="fa fa-check"></i>Question 5</a></li>
<li class="chapter" data-level="" data-path="distance-and-dimension-reduction.html"><a href="distance-and-dimension-reduction.html#question-6-12"><i class="fa fa-check"></i>Question 6</a></li>
<li class="chapter" data-level="" data-path="distance-and-dimension-reduction.html"><a href="distance-and-dimension-reduction.html#question-7-10"><i class="fa fa-check"></i>Question 7</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="distance-and-dimension-reduction.html"><a href="distance-and-dimension-reduction.html#exercises-27"><i class="fa fa-check"></i>8.11 Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="distance-and-dimension-reduction.html"><a href="distance-and-dimension-reduction.html#question-1-29"><i class="fa fa-check"></i>Question 1</a></li>
<li class="chapter" data-level="" data-path="distance-and-dimension-reduction.html"><a href="distance-and-dimension-reduction.html#question-2-27"><i class="fa fa-check"></i>Question 2</a></li>
<li class="chapter" data-level="" data-path="distance-and-dimension-reduction.html"><a href="distance-and-dimension-reduction.html#question-3-25"><i class="fa fa-check"></i>Question 3</a></li>
<li class="chapter" data-level="" data-path="distance-and-dimension-reduction.html"><a href="distance-and-dimension-reduction.html#question-4-22"><i class="fa fa-check"></i>Question 4</a></li>
<li class="chapter" data-level="" data-path="distance-and-dimension-reduction.html"><a href="distance-and-dimension-reduction.html#question-5-15"><i class="fa fa-check"></i>Question 5</a></li>
<li class="chapter" data-level="" data-path="distance-and-dimension-reduction.html"><a href="distance-and-dimension-reduction.html#question-6-13"><i class="fa fa-check"></i>Question 6</a></li>
<li class="chapter" data-level="" data-path="distance-and-dimension-reduction.html"><a href="distance-and-dimension-reduction.html#question-7-11"><i class="fa fa-check"></i>Question 7</a></li>
<li class="chapter" data-level="" data-path="distance-and-dimension-reduction.html"><a href="distance-and-dimension-reduction.html#question-8-9"><i class="fa fa-check"></i>Question 8</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="basic-machine-learning.html"><a href="basic-machine-learning.html"><i class="fa fa-check"></i><b>9</b> Basic Machine Learning</a>
<ul>
<li class="chapter" data-level="" data-path="basic-machine-learning.html"><a href="basic-machine-learning.html#exercises-28"><i class="fa fa-check"></i>9.2 Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="basic-machine-learning.html"><a href="basic-machine-learning.html#question-1-30"><i class="fa fa-check"></i>Question 1</a></li>
<li class="chapter" data-level="" data-path="basic-machine-learning.html"><a href="basic-machine-learning.html#question-2-28"><i class="fa fa-check"></i>Question 2</a></li>
<li class="chapter" data-level="" data-path="basic-machine-learning.html"><a href="basic-machine-learning.html#question-3-26"><i class="fa fa-check"></i>Question 3</a></li>
<li class="chapter" data-level="" data-path="basic-machine-learning.html"><a href="basic-machine-learning.html#question-4-23"><i class="fa fa-check"></i>Question 4</a></li>
<li class="chapter" data-level="" data-path="basic-machine-learning.html"><a href="basic-machine-learning.html#question-5-16"><i class="fa fa-check"></i>Question 5</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="basic-machine-learning.html"><a href="basic-machine-learning.html#exercises-29"><i class="fa fa-check"></i>9.4 Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="basic-machine-learning.html"><a href="basic-machine-learning.html#question-1-31"><i class="fa fa-check"></i>Question 1</a></li>
<li class="chapter" data-level="" data-path="basic-machine-learning.html"><a href="basic-machine-learning.html#question-2-29"><i class="fa fa-check"></i>Question 2</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="basic-machine-learning.html"><a href="basic-machine-learning.html#exercises-30"><i class="fa fa-check"></i>9.8 Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="basic-machine-learning.html"><a href="basic-machine-learning.html#question-1-32"><i class="fa fa-check"></i>Question 1</a></li>
<li class="chapter" data-level="" data-path="basic-machine-learning.html"><a href="basic-machine-learning.html#question-2-30"><i class="fa fa-check"></i>Question 2</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="basic-machine-learning.html"><a href="basic-machine-learning.html#exercises-31"><i class="fa fa-check"></i>9.11 Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="basic-machine-learning.html"><a href="basic-machine-learning.html#question-1-33"><i class="fa fa-check"></i>Question 1</a></li>
<li class="chapter" data-level="" data-path="basic-machine-learning.html"><a href="basic-machine-learning.html#question-2-31"><i class="fa fa-check"></i>Question 2</a></li>
<li class="chapter" data-level="" data-path="basic-machine-learning.html"><a href="basic-machine-learning.html#question-3-27"><i class="fa fa-check"></i>Question 3</a></li>
<li class="chapter" data-level="" data-path="basic-machine-learning.html"><a href="basic-machine-learning.html#question-4-24"><i class="fa fa-check"></i>Question 4</a></li>
<li class="chapter" data-level="" data-path="basic-machine-learning.html"><a href="basic-machine-learning.html#question-5-17"><i class="fa fa-check"></i>Question 5</a></li>
<li class="chapter" data-level="" data-path="basic-machine-learning.html"><a href="basic-machine-learning.html#question-6-14"><i class="fa fa-check"></i>Question 6</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="batch-effects.html"><a href="batch-effects.html"><i class="fa fa-check"></i><b>10</b> Batch Effects</a>
<ul>
<li class="chapter" data-level="" data-path="batch-effects.html"><a href="batch-effects.html#exercises-32"><i class="fa fa-check"></i>10.3 Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="batch-effects.html"><a href="batch-effects.html#question-1-34"><i class="fa fa-check"></i>Question 1</a></li>
<li class="chapter" data-level="" data-path="batch-effects.html"><a href="batch-effects.html#question-2-32"><i class="fa fa-check"></i>Question 2</a></li>
<li class="chapter" data-level="" data-path="batch-effects.html"><a href="batch-effects.html#question-3-28"><i class="fa fa-check"></i>Question 3</a></li>
<li class="chapter" data-level="" data-path="batch-effects.html"><a href="batch-effects.html#question-4-25"><i class="fa fa-check"></i>Question 4</a></li>
<li class="chapter" data-level="" data-path="batch-effects.html"><a href="batch-effects.html#question-5-18"><i class="fa fa-check"></i>Question 5</a></li>
<li class="chapter" data-level="" data-path="batch-effects.html"><a href="batch-effects.html#question-6-15"><i class="fa fa-check"></i>Question 6</a></li>
<li class="chapter" data-level="" data-path="batch-effects.html"><a href="batch-effects.html#question-7-12"><i class="fa fa-check"></i>Question 7</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="batch-effects.html"><a href="batch-effects.html#exercises-33"><i class="fa fa-check"></i>10.6 Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="batch-effects.html"><a href="batch-effects.html#question-1-35"><i class="fa fa-check"></i>Question 1</a></li>
<li class="chapter" data-level="" data-path="batch-effects.html"><a href="batch-effects.html#question-2-33"><i class="fa fa-check"></i>Question 2</a></li>
<li class="chapter" data-level="" data-path="batch-effects.html"><a href="batch-effects.html#question-3-29"><i class="fa fa-check"></i>Question 3</a></li>
<li class="chapter" data-level="" data-path="batch-effects.html"><a href="batch-effects.html#question-4-26"><i class="fa fa-check"></i>Question 4</a></li>
<li class="chapter" data-level="" data-path="batch-effects.html"><a href="batch-effects.html#question-5-19"><i class="fa fa-check"></i>Question 5</a></li>
<li class="chapter" data-level="" data-path="batch-effects.html"><a href="batch-effects.html#question-6-16"><i class="fa fa-check"></i>Question 6</a></li>
<li class="chapter" data-level="" data-path="batch-effects.html"><a href="batch-effects.html#question-7-13"><i class="fa fa-check"></i>Question 7</a></li>
<li class="chapter" data-level="" data-path="batch-effects.html"><a href="batch-effects.html#question-8-10"><i class="fa fa-check"></i>Question 8</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="batch-effects.html"><a href="batch-effects.html#exercises-34"><i class="fa fa-check"></i>10.9 Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="batch-effects.html"><a href="batch-effects.html#question-1-36"><i class="fa fa-check"></i>Question 1</a></li>
<li class="chapter" data-level="" data-path="batch-effects.html"><a href="batch-effects.html#question-2-34"><i class="fa fa-check"></i>Question 2</a></li>
<li class="chapter" data-level="" data-path="batch-effects.html"><a href="batch-effects.html#question-3-30"><i class="fa fa-check"></i>Question 3</a></li>
<li class="chapter" data-level="" data-path="batch-effects.html"><a href="batch-effects.html#question-4-27"><i class="fa fa-check"></i>Question 4</a></li>
<li class="chapter" data-level="" data-path="batch-effects.html"><a href="batch-effects.html#question-5-20"><i class="fa fa-check"></i>Question 5</a></li>
<li class="chapter" data-level="" data-path="batch-effects.html"><a href="batch-effects.html#question-6-17"><i class="fa fa-check"></i>Question 6</a></li>
<li class="chapter" data-level="" data-path="batch-effects.html"><a href="batch-effects.html#question-7-14"><i class="fa fa-check"></i>Question 7</a></li>
<li class="chapter" data-level="" data-path="batch-effects.html"><a href="batch-effects.html#question-8-11"><i class="fa fa-check"></i>Question 8</a></li>
<li class="chapter" data-level="" data-path="batch-effects.html"><a href="batch-effects.html#question-9-9"><i class="fa fa-check"></i>Question 9</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="batch-effects.html"><a href="batch-effects.html#exercises-35"><i class="fa fa-check"></i>10.11 Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="batch-effects.html"><a href="batch-effects.html#question-1-37"><i class="fa fa-check"></i>Question 1</a></li>
<li class="chapter" data-level="" data-path="batch-effects.html"><a href="batch-effects.html#question-2-35"><i class="fa fa-check"></i>Question 2</a></li>
<li class="chapter" data-level="" data-path="batch-effects.html"><a href="batch-effects.html#question-3-31"><i class="fa fa-check"></i>Question 3</a></li>
<li class="chapter" data-level="" data-path="batch-effects.html"><a href="batch-effects.html#question-4-28"><i class="fa fa-check"></i>Question 4</a></li>
<li class="chapter" data-level="" data-path="batch-effects.html"><a href="batch-effects.html#question-5-21"><i class="fa fa-check"></i>Question 5</a></li>
<li class="chapter" data-level="" data-path="batch-effects.html"><a href="batch-effects.html#question-6-18"><i class="fa fa-check"></i>Question 6</a></li>
<li class="chapter" data-level="" data-path="batch-effects.html"><a href="batch-effects.html#question-7-15"><i class="fa fa-check"></i>Question 7</a></li>
<li class="chapter" data-level="" data-path="batch-effects.html"><a href="batch-effects.html#question-8-12"><i class="fa fa-check"></i>Question 8</a></li>
<li class="chapter" data-level="" data-path="batch-effects.html"><a href="batch-effects.html#question-9-10"><i class="fa fa-check"></i>Question 9</a></li>
<li class="chapter" data-level="" data-path="batch-effects.html"><a href="batch-effects.html#question-10-8"><i class="fa fa-check"></i>Question 10</a></li>
<li class="chapter" data-level="" data-path="batch-effects.html"><a href="batch-effects.html#question-11-5"><i class="fa fa-check"></i>Question 11</a></li>
<li class="chapter" data-level="" data-path="batch-effects.html"><a href="batch-effects.html#question-12-5"><i class="fa fa-check"></i>Question 12</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="batch-effects.html"><a href="batch-effects.html#exercises-36"><i class="fa fa-check"></i>10.13 Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="batch-effects.html"><a href="batch-effects.html#question-1-38"><i class="fa fa-check"></i>Question 1</a></li>
<li class="chapter" data-level="" data-path="batch-effects.html"><a href="batch-effects.html#question-2-36"><i class="fa fa-check"></i>Question 2</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data Analysis for the Life Sciences with R: Exercise Solutions</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="basic-machine-learning" class="section level1" number="9">
<h1><span class="header-section-number">Chapter 9</span> Basic Machine Learning</h1>
<p><strong>Note:</strong> I have rephrased some parts of the questions for clarity. These changes are <strong>bolded</strong>. Due to the random numbers, the exact values of the answers, despite the same seeds, might differ. So please be mindful of that.</p>
<p>First, upload necessary package(s).</p>
<div class="sourceCode" id="cb628"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb628-1"><a href="basic-machine-learning.html#cb628-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr) <span class="co"># uplaods the function filter() and %&gt;%</span></span>
<span id="cb628-2"><a href="basic-machine-learning.html#cb628-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rafalib) <span class="co"># important for plotting with base R</span></span>
<span id="cb628-3"><a href="basic-machine-learning.html#cb628-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(genefilter) <span class="co"># rowttests</span></span>
<span id="cb628-4"><a href="basic-machine-learning.html#cb628-4" aria-hidden="true" tabindex="-1"></a><span class="co">#library(devtools) # allows download from github</span></span>
<span id="cb628-5"><a href="basic-machine-learning.html#cb628-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(GSE5859Subset) <span class="co"># subset of gene expression data</span></span>
<span id="cb628-6"><a href="basic-machine-learning.html#cb628-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tissuesGeneExpression)</span>
<span id="cb628-7"><a href="basic-machine-learning.html#cb628-7" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(tissuesGeneExpression)</span>
<span id="cb628-8"><a href="basic-machine-learning.html#cb628-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RColorBrewer)</span>
<span id="cb628-9"><a href="basic-machine-learning.html#cb628-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret) <span class="co"># for createFold</span></span>
<span id="cb628-10"><a href="basic-machine-learning.html#cb628-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gplots) <span class="co"># for heatmap</span></span>
<span id="cb628-11"><a href="basic-machine-learning.html#cb628-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(class) <span class="co"># for knn</span></span>
<span id="cb628-12"><a href="basic-machine-learning.html#cb628-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(matrixStats)</span></code></pre></div>
<div id="exercises-28" class="section level2 unnumbered">
<h2>9.2 Exercises</h2>
<div id="question-1-30" class="section level3 unnumbered">
<h3>Question 1</h3>
<p>Create a random matrix with no correlation in the following way:</p>
<div class="sourceCode" id="cb629"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb629-1"><a href="basic-machine-learning.html#cb629-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb629-2"><a href="basic-machine-learning.html#cb629-2" aria-hidden="true" tabindex="-1"></a>m <span class="ot">=</span> <span class="dv">10000</span></span>
<span id="cb629-3"><a href="basic-machine-learning.html#cb629-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">=</span> <span class="dv">24</span></span>
<span id="cb629-4"><a href="basic-machine-learning.html#cb629-4" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(m<span class="sc">*</span>n),m,n)</span>
<span id="cb629-5"><a href="basic-machine-learning.html#cb629-5" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(x)<span class="ot">=</span><span class="dv">1</span><span class="sc">:</span>n</span></code></pre></div>
<p>Run hierarchical clustering on this data with the hclust function with default parameters to cluster the columns. Create a dendrogram. In the dendrogram, which pairs of samples are the furthest away from each other?</p>
<hr />
<div class="sourceCode" id="cb630"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb630-1"><a href="basic-machine-learning.html#cb630-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">dist</span>(<span class="fu">t</span>(x))</span>
<span id="cb630-2"><a href="basic-machine-learning.html#cb630-2" aria-hidden="true" tabindex="-1"></a>hc <span class="ot">&lt;-</span> <span class="fu">hclust</span>(d)</span>
<span id="cb630-3"><a href="basic-machine-learning.html#cb630-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mypar</span>()</span>
<span id="cb630-4"><a href="basic-machine-learning.html#cb630-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(hc)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-345-1.png" width="672" /></p>
<div class="sourceCode" id="cb631"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb631-1"><a href="basic-machine-learning.html#cb631-1" aria-hidden="true" tabindex="-1"></a><span class="co">#7 and 23 - 141</span></span>
<span id="cb631-2"><a href="basic-machine-learning.html#cb631-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 19 and 14 - 143</span></span>
<span id="cb631-3"><a href="basic-machine-learning.html#cb631-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 1 and 16 - 142</span></span>
<span id="cb631-4"><a href="basic-machine-learning.html#cb631-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 17 and 18 - 142</span></span></code></pre></div>
<p>The answer is <strong>B: 19 and 14</strong>. The answer might be different due to the random numbers.</p>
</div>
<div id="question-2-28" class="section level3 unnumbered">
<h3>Question 2</h3>
<p>Set the seed at 1, set.seed(1) and replicate the creation of this matrix <strong>100 times</strong>:</p>
<div class="sourceCode" id="cb632"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb632-1"><a href="basic-machine-learning.html#cb632-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">=</span> <span class="dv">10000</span></span>
<span id="cb632-2"><a href="basic-machine-learning.html#cb632-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">=</span> <span class="dv">24</span></span>
<span id="cb632-3"><a href="basic-machine-learning.html#cb632-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(m<span class="sc">*</span>n),m,n)</span></code></pre></div>
<p>then perform hierarchical clustering as in the solution to <strong>Question 1</strong>, and find the number of clusters if you use cuttree at height 143. This number is a random variable. Based on the Monte Carlo simulation, what is the standard error of this random variable?</p>
<hr />
<div class="sourceCode" id="cb633"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb633-1"><a href="basic-machine-learning.html#cb633-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb633-2"><a href="basic-machine-learning.html#cb633-2" aria-hidden="true" tabindex="-1"></a>res_list <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">100</span>, {</span>
<span id="cb633-3"><a href="basic-machine-learning.html#cb633-3" aria-hidden="true" tabindex="-1"></a>  m <span class="ot">=</span> <span class="dv">10000</span></span>
<span id="cb633-4"><a href="basic-machine-learning.html#cb633-4" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">=</span> <span class="dv">24</span></span>
<span id="cb633-5"><a href="basic-machine-learning.html#cb633-5" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">=</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(m<span class="sc">*</span>n),m,n)</span>
<span id="cb633-6"><a href="basic-machine-learning.html#cb633-6" aria-hidden="true" tabindex="-1"></a>  d <span class="ot">&lt;-</span> <span class="fu">dist</span>(<span class="fu">t</span>(x))</span>
<span id="cb633-7"><a href="basic-machine-learning.html#cb633-7" aria-hidden="true" tabindex="-1"></a>  hc <span class="ot">&lt;-</span> <span class="fu">hclust</span>(d)</span>
<span id="cb633-8"><a href="basic-machine-learning.html#cb633-8" aria-hidden="true" tabindex="-1"></a>  hclusters <span class="ot">&lt;-</span> <span class="fu">cutree</span>(hc, <span class="at">h=</span><span class="dv">143</span>)</span>
<span id="cb633-9"><a href="basic-machine-learning.html#cb633-9" aria-hidden="true" tabindex="-1"></a>  num_clus <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">unique</span>(hclusters))</span>
<span id="cb633-10"><a href="basic-machine-learning.html#cb633-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(num_clus)</span>
<span id="cb633-11"><a href="basic-machine-learning.html#cb633-11" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb633-12"><a href="basic-machine-learning.html#cb633-12" aria-hidden="true" tabindex="-1"></a><span class="fu">popsd</span>(res_list)</span></code></pre></div>
<pre><code>## [1] 0.8986657</code></pre>
</div>
<div id="question-3-26" class="section level3 unnumbered">
<h3>Question 3</h3>
<p>Run <code>kmeans</code> with 4 centers for the blood RNA data:</p>
<div class="sourceCode" id="cb635"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb635-1"><a href="basic-machine-learning.html#cb635-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(GSE5859Subset)</span>
<span id="cb635-2"><a href="basic-machine-learning.html#cb635-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(GSE5859Subset)</span></code></pre></div>
<p>Set the seed to 10, <code>set.seed(10)</code> right before running <code>kmeans</code> with 5 centers. Explore the relationship of clusters and information in sampleInfo. Which of the following best describes what you find?</p>
<hr />
<div class="sourceCode" id="cb636"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb636-1"><a href="basic-machine-learning.html#cb636-1" aria-hidden="true" tabindex="-1"></a>km <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(<span class="fu">t</span>(geneExpression), <span class="at">centers =</span> <span class="dv">5</span>)</span>
<span id="cb636-2"><a href="basic-machine-learning.html#cb636-2" aria-hidden="true" tabindex="-1"></a>km<span class="sc">$</span>cluster</span></code></pre></div>
<pre><code>## GSM136508.CEL.gz GSM136530.CEL.gz GSM136517.CEL.gz GSM136576.CEL.gz 
##                2                1                1                5 
## GSM136566.CEL.gz GSM136574.CEL.gz GSM136575.CEL.gz GSM136569.CEL.gz 
##                3                5                5                4 
## GSM136568.CEL.gz GSM136559.CEL.gz GSM136565.CEL.gz GSM136573.CEL.gz 
##                5                3                3                4 
## GSM136523.CEL.gz GSM136509.CEL.gz GSM136727.CEL.gz GSM136510.CEL.gz 
##                1                2                2                2 
## GSM136515.CEL.gz GSM136522.CEL.gz GSM136507.CEL.gz GSM136524.CEL.gz 
##                2                1                2                1 
## GSM136514.CEL.gz GSM136563.CEL.gz GSM136564.CEL.gz GSM136572.CEL.gz 
##                1                3                3                4</code></pre>
<div class="sourceCode" id="cb638"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb638-1"><a href="basic-machine-learning.html#cb638-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(<span class="at">true =</span> sampleInfo<span class="sc">$</span>group, <span class="at">cluster =</span> km<span class="sc">$</span>cluster)</span></code></pre></div>
<pre><code>##     cluster
## true 1 2 3 4 5
##    0 4 5 2 1 0
##    1 2 1 3 2 4</code></pre>
<div class="sourceCode" id="cb640"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb640-1"><a href="basic-machine-learning.html#cb640-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(<span class="at">true =</span> sampleInfo<span class="sc">$</span>date, <span class="at">cluster =</span> km<span class="sc">$</span>cluster)</span></code></pre></div>
<pre><code>##             cluster
## true         1 2 3 4 5
##   2005-06-10 0 1 0 0 0
##   2005-06-23 1 5 0 0 0
##   2005-06-27 5 0 0 0 0
##   2005-10-07 0 0 5 3 2
##   2005-10-28 0 0 0 0 2</code></pre>
<p>The answer is <strong>C: Date is driving the clusters</strong>.</p>
</div>
<div id="question-4-23" class="section level3 unnumbered">
<h3>Question 4</h3>
<p>Load the data:</p>
<div class="sourceCode" id="cb642"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb642-1"><a href="basic-machine-learning.html#cb642-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(GSE5859Subset)</span>
<span id="cb642-2"><a href="basic-machine-learning.html#cb642-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(GSE5859Subset)</span></code></pre></div>
<p>Pick the 25 genes with the highest across sample variance. This function might help:</p>
<div class="sourceCode" id="cb643"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb643-1"><a href="basic-machine-learning.html#cb643-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(matrixStats)</span></code></pre></div>
<p>Use <code>heatmap.2</code> to make a heatmap showing the <code>sampleInfo$group</code> with color, the date as labels, the rows labelled with chromosome, and scaling the rows. What do we learn from this heatmap?</p>
<hr />
<div class="sourceCode" id="cb644"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb644-1"><a href="basic-machine-learning.html#cb644-1" aria-hidden="true" tabindex="-1"></a>hmcol <span class="ot">&lt;-</span> <span class="fu">colorRampPalette</span>(<span class="fu">brewer.pal</span>(<span class="dv">9</span>, <span class="st">&quot;GnBu&quot;</span>))(<span class="dv">100</span>)</span>
<span id="cb644-2"><a href="basic-machine-learning.html#cb644-2" aria-hidden="true" tabindex="-1"></a>month <span class="ot">=</span> <span class="fu">format</span>( sampleInfo<span class="sc">$</span>date, <span class="st">&quot;%m&quot;</span>)</span>
<span id="cb644-3"><a href="basic-machine-learning.html#cb644-3" aria-hidden="true" tabindex="-1"></a>rv <span class="ot">&lt;-</span> <span class="fu">rowVars</span>(geneExpression)</span>
<span id="cb644-4"><a href="basic-machine-learning.html#cb644-4" aria-hidden="true" tabindex="-1"></a>idx <span class="ot">&lt;-</span> <span class="fu">order</span>(<span class="sc">-</span>rv)[<span class="dv">1</span><span class="sc">:</span><span class="dv">25</span>]</span>
<span id="cb644-5"><a href="basic-machine-learning.html#cb644-5" aria-hidden="true" tabindex="-1"></a>cols <span class="ot">&lt;-</span> <span class="fu">palette</span>(<span class="fu">brewer.pal</span>(<span class="dv">8</span>, <span class="st">&quot;Dark2&quot;</span>))[<span class="fu">as.fumeric</span>(<span class="fu">as.character</span>(sampleInfo<span class="sc">$</span>group))]</span>
<span id="cb644-6"><a href="basic-machine-learning.html#cb644-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb644-7"><a href="basic-machine-learning.html#cb644-7" aria-hidden="true" tabindex="-1"></a><span class="fu">heatmap.2</span>(geneExpression[idx,], </span>
<span id="cb644-8"><a href="basic-machine-learning.html#cb644-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">trace =</span> <span class="st">&#39;none&#39;</span>, <span class="at">labRow =</span> geneAnnotation[idx,]<span class="sc">$</span>CHR,</span>
<span id="cb644-9"><a href="basic-machine-learning.html#cb644-9" aria-hidden="true" tabindex="-1"></a>          <span class="at">col =</span> hmcol, <span class="at">labCol =</span> month,</span>
<span id="cb644-10"><a href="basic-machine-learning.html#cb644-10" aria-hidden="true" tabindex="-1"></a>          <span class="at">ColSideColors =</span> cols)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-352-1.png" width="672" /></p>
<p>The correct answer is <strong>C</strong>: A group of chrY genes are higher in group 0 and appear to drive the clustering.
Within those clusters there appears to be clustering by month.</p>
<p>I thought this question was tricky because it was not straightforward for me to draw the heatmap with many inputs. First, the orange and green colors represent the sample group (0 or 1). This was established in the code <code>cols &lt;- palette(brewer.pal(8, "Dark2"))[as.fumeric(as.character(sampleInfo$group))]</code> which then acted as input for <code>ColSideColors</code> in <code>heatmap.2</code> function. <code>labRow</code> refers to the labelling of row, which in this case is chromosome <code>geneAnnotation[idx,]$CHR</code>. <code>labCol</code> has nothing to do with color; it has to do with column labelling, which in this case is <code>month</code>. <code>col</code> represents color for the values of the data <code>geneExpression[idx,]</code>.</p>
<p>Answer A is wrong because if the data were generated by <code>norm</code>, the color distribution of the heatmap would be entirely random. Answer B is wrong because the colors in the row <code>chr1</code> are more or less the same except for one column (one sample). Answer D is wrong <code>chrY</code> genes are higher in June, not October.</p>
</div>
<div id="question-5-16" class="section level3 unnumbered">
<h3>Question 5</h3>
<p>Create a large dataset of random data that is completely independent of <code>sampleInfo$group</code> like this:</p>
<div class="sourceCode" id="cb645"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb645-1"><a href="basic-machine-learning.html#cb645-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">17</span>)</span>
<span id="cb645-2"><a href="basic-machine-learning.html#cb645-2" aria-hidden="true" tabindex="-1"></a>m <span class="ot">=</span> <span class="fu">nrow</span>(geneExpression)</span>
<span id="cb645-3"><a href="basic-machine-learning.html#cb645-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">=</span> <span class="fu">ncol</span>(geneExpression)</span>
<span id="cb645-4"><a href="basic-machine-learning.html#cb645-4" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(m<span class="sc">*</span>n),m,n)</span>
<span id="cb645-5"><a href="basic-machine-learning.html#cb645-5" aria-hidden="true" tabindex="-1"></a>g <span class="ot">=</span> <span class="fu">factor</span>(sampleInfo<span class="sc">$</span>g)</span></code></pre></div>
<p>Create two heatmaps with these data. Show the group g either with labels or colors. First, take the 50 genes with smallest p-values obtained with <code>rowttests</code>. Then, take the 50 genes with largest standard deviations. Which of the following statements is true?</p>
<hr />
<div class="sourceCode" id="cb646"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb646-1"><a href="basic-machine-learning.html#cb646-1" aria-hidden="true" tabindex="-1"></a><span class="co"># p-value</span></span>
<span id="cb646-2"><a href="basic-machine-learning.html#cb646-2" aria-hidden="true" tabindex="-1"></a>pvals <span class="ot">&lt;-</span> <span class="fu">rowttests</span>(x, g)<span class="sc">$</span>p.value</span>
<span id="cb646-3"><a href="basic-machine-learning.html#cb646-3" aria-hidden="true" tabindex="-1"></a>idx <span class="ot">&lt;-</span> <span class="fu">order</span>(pvals)[<span class="dv">1</span><span class="sc">:</span><span class="dv">50</span>]</span>
<span id="cb646-4"><a href="basic-machine-learning.html#cb646-4" aria-hidden="true" tabindex="-1"></a>cols <span class="ot">&lt;-</span> <span class="fu">palette</span>(<span class="fu">brewer.pal</span>(<span class="dv">8</span>, <span class="st">&quot;Dark2&quot;</span>))[<span class="fu">as.fumeric</span>(<span class="fu">as.character</span>(sampleInfo<span class="sc">$</span>g))]</span>
<span id="cb646-5"><a href="basic-machine-learning.html#cb646-5" aria-hidden="true" tabindex="-1"></a><span class="fu">heatmap.2</span>(x[idx,], </span>
<span id="cb646-6"><a href="basic-machine-learning.html#cb646-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">trace =</span> <span class="st">&#39;none&#39;</span>, <span class="at">labRow =</span> geneAnnotation[idx,]<span class="sc">$</span>CHR,</span>
<span id="cb646-7"><a href="basic-machine-learning.html#cb646-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">col =</span> hmcol, <span class="at">labCol =</span> month,</span>
<span id="cb646-8"><a href="basic-machine-learning.html#cb646-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">ColSideColors =</span> cols)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-354-1.png" width="672" /></p>
<div class="sourceCode" id="cb647"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb647-1"><a href="basic-machine-learning.html#cb647-1" aria-hidden="true" tabindex="-1"></a><span class="co"># std dev</span></span>
<span id="cb647-2"><a href="basic-machine-learning.html#cb647-2" aria-hidden="true" tabindex="-1"></a>sds <span class="ot">&lt;-</span> genefilter<span class="sc">::</span><span class="fu">rowSds</span>(x,g)</span>
<span id="cb647-3"><a href="basic-machine-learning.html#cb647-3" aria-hidden="true" tabindex="-1"></a>idx <span class="ot">&lt;-</span> <span class="fu">order</span>(<span class="sc">-</span>sds)[<span class="dv">1</span><span class="sc">:</span><span class="dv">50</span>]</span>
<span id="cb647-4"><a href="basic-machine-learning.html#cb647-4" aria-hidden="true" tabindex="-1"></a>cols <span class="ot">&lt;-</span> <span class="fu">palette</span>(<span class="fu">brewer.pal</span>(<span class="dv">8</span>, <span class="st">&quot;Dark2&quot;</span>))[<span class="fu">as.fumeric</span>(<span class="fu">as.character</span>(sampleInfo<span class="sc">$</span>g))]</span>
<span id="cb647-5"><a href="basic-machine-learning.html#cb647-5" aria-hidden="true" tabindex="-1"></a><span class="fu">heatmap.2</span>(x[idx,], </span>
<span id="cb647-6"><a href="basic-machine-learning.html#cb647-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">trace =</span> <span class="st">&#39;none&#39;</span>, <span class="at">labRow =</span> geneAnnotation[idx,]<span class="sc">$</span>CHR,</span>
<span id="cb647-7"><a href="basic-machine-learning.html#cb647-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">col =</span> hmcol, <span class="at">labCol =</span> month,</span>
<span id="cb647-8"><a href="basic-machine-learning.html#cb647-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">ColSideColors =</span> cols)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-354-2.png" width="672" /></p>
<p>The answer is <strong>A</strong>: There is no relationship between g and x, but with 8,793 tests some will appear significant by chance. Selecting genes with the t-test gives us a deceiving result.</p>
<p>Recall that we have already selected smallest p-values from a dataset in which the null hypothesis is true. Therefore, we can see clusters that indicate that there is a significant difference between sample groups. However, this significance is not real because we know that the null hypothesis is true.</p>
</div>
</div>
<div id="exercises-29" class="section level2 unnumbered">
<h2>9.4 Exercises</h2>
<div id="question-1-31" class="section level3 unnumbered">
<h3>Question 1</h3>
<p>Generate some random data to imitate heights for men (0) and women (1):</p>
<div class="sourceCode" id="cb648"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb648-1"><a href="basic-machine-learning.html#cb648-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">=</span> <span class="dv">10000</span></span>
<span id="cb648-2"><a href="basic-machine-learning.html#cb648-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb648-3"><a href="basic-machine-learning.html#cb648-3" aria-hidden="true" tabindex="-1"></a>men <span class="ot">=</span> <span class="fu">rnorm</span>(n,<span class="dv">176</span>,<span class="dv">7</span>) <span class="co">#height in centimeters</span></span>
<span id="cb648-4"><a href="basic-machine-learning.html#cb648-4" aria-hidden="true" tabindex="-1"></a>women <span class="ot">=</span> <span class="fu">rnorm</span>(n,<span class="dv">162</span>,<span class="dv">7</span>) <span class="co">#height in centimeters</span></span>
<span id="cb648-5"><a href="basic-machine-learning.html#cb648-5" aria-hidden="true" tabindex="-1"></a>y <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>,n),<span class="fu">rep</span>(<span class="dv">1</span>,n))</span>
<span id="cb648-6"><a href="basic-machine-learning.html#cb648-6" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">c</span>(men,women))</span>
<span id="cb648-7"><a href="basic-machine-learning.html#cb648-7" aria-hidden="true" tabindex="-1"></a><span class="do">##mix it up</span></span>
<span id="cb648-8"><a href="basic-machine-learning.html#cb648-8" aria-hidden="true" tabindex="-1"></a>ind <span class="ot">=</span> <span class="fu">sample</span>(<span class="fu">seq</span>(<span class="at">along=</span>y))</span>
<span id="cb648-9"><a href="basic-machine-learning.html#cb648-9" aria-hidden="true" tabindex="-1"></a>y <span class="ot">=</span> y[ind]</span>
<span id="cb648-10"><a href="basic-machine-learning.html#cb648-10" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> x[ind]</span></code></pre></div>
<p>Using the data generated above, what is the <span class="math inline">\(E(Y|X=176)\)</span> (proportion of females)?</p>
<hr />
<div class="sourceCode" id="cb649"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb649-1"><a href="basic-machine-learning.html#cb649-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(y[x<span class="sc">==</span><span class="dv">176</span>])</span></code></pre></div>
<pre><code>## [1] 0.1049475</code></pre>
</div>
<div id="question-2-29" class="section level3 unnumbered">
<h3>Question 2</h3>
<p>Now make a plot of <span class="math inline">\(E(Y|X=x)\)</span> for <code>x=seq(160,178)</code> using the data generated in <strong>Question 1</strong>.</p>
<p>If you are predicting female or male based on height and want your probability of success to be larger than 0.5, what is the largest height where you predict female?</p>
<hr />
<div class="sourceCode" id="cb651"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb651-1"><a href="basic-machine-learning.html#cb651-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mypar</span>()</span>
<span id="cb651-2"><a href="basic-machine-learning.html#cb651-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x,y)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-357-1.png" width="672" /></p>
<div class="sourceCode" id="cb652"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb652-1"><a href="basic-machine-learning.html#cb652-1" aria-hidden="true" tabindex="-1"></a>x_list <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">160</span>,<span class="dv">178</span>)</span>
<span id="cb652-2"><a href="basic-machine-learning.html#cb652-2" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">&#39;double&#39;</span>, <span class="fu">length</span>(x_list))</span>
<span id="cb652-3"><a href="basic-machine-learning.html#cb652-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(x_list)) {</span>
<span id="cb652-4"><a href="basic-machine-learning.html#cb652-4" aria-hidden="true" tabindex="-1"></a>  res[[i]] <span class="ot">&lt;-</span> <span class="fu">mean</span>(y[x<span class="sc">==</span>x_list[[i]]])</span>
<span id="cb652-5"><a href="basic-machine-learning.html#cb652-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb652-6"><a href="basic-machine-learning.html#cb652-6" aria-hidden="true" tabindex="-1"></a>ind <span class="ot">&lt;-</span> <span class="fu">max</span>(<span class="fu">which</span>(res <span class="sc">&gt;</span> <span class="fl">0.5</span>))</span>
<span id="cb652-7"><a href="basic-machine-learning.html#cb652-7" aria-hidden="true" tabindex="-1"></a>x_list[ind] <span class="co"># answer</span></span></code></pre></div>
<pre><code>## [1] 168</code></pre>
<div class="sourceCode" id="cb654"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb654-1"><a href="basic-machine-learning.html#cb654-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(y[x<span class="sc">==</span><span class="dv">168</span>])</span></code></pre></div>
<pre><code>## [1] 0.5787172</code></pre>
</div>
</div>
<div id="exercises-30" class="section level2 unnumbered">
<h2>9.8 Exercises</h2>
<div id="question-1-32" class="section level3 unnumbered">
<h3>Question 1</h3>
<p>Generate the following data:</p>
<div class="sourceCode" id="cb656"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb656-1"><a href="basic-machine-learning.html#cb656-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">=</span> <span class="dv">10000</span></span>
<span id="cb656-2"><a href="basic-machine-learning.html#cb656-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb656-3"><a href="basic-machine-learning.html#cb656-3" aria-hidden="true" tabindex="-1"></a>men <span class="ot">=</span> <span class="fu">rnorm</span>(n,<span class="dv">176</span>,<span class="dv">7</span>) <span class="co">#height in centimeters</span></span>
<span id="cb656-4"><a href="basic-machine-learning.html#cb656-4" aria-hidden="true" tabindex="-1"></a>women <span class="ot">=</span> <span class="fu">rnorm</span>(n,<span class="dv">162</span>,<span class="dv">7</span>) <span class="co">#height in centimeters</span></span>
<span id="cb656-5"><a href="basic-machine-learning.html#cb656-5" aria-hidden="true" tabindex="-1"></a>y <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>,n),<span class="fu">rep</span>(<span class="dv">1</span>,n))</span>
<span id="cb656-6"><a href="basic-machine-learning.html#cb656-6" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">c</span>(men,women))</span>
<span id="cb656-7"><a href="basic-machine-learning.html#cb656-7" aria-hidden="true" tabindex="-1"></a><span class="do">##mix it up</span></span>
<span id="cb656-8"><a href="basic-machine-learning.html#cb656-8" aria-hidden="true" tabindex="-1"></a>ind <span class="ot">=</span> <span class="fu">sample</span>(<span class="fu">seq</span>(<span class="at">along=</span>y))</span>
<span id="cb656-9"><a href="basic-machine-learning.html#cb656-9" aria-hidden="true" tabindex="-1"></a>y <span class="ot">=</span> y[ind]</span>
<span id="cb656-10"><a href="basic-machine-learning.html#cb656-10" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> x[ind]</span></code></pre></div>
<p>Set the seed at 5, <code>set.seed(5)</code> and take a random sample of 250 from:</p>
<div class="sourceCode" id="cb657"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb657-1"><a href="basic-machine-learning.html#cb657-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">5</span>)</span>
<span id="cb657-2"><a href="basic-machine-learning.html#cb657-2" aria-hidden="true" tabindex="-1"></a>N <span class="ot">=</span> <span class="dv">250</span></span>
<span id="cb657-3"><a href="basic-machine-learning.html#cb657-3" aria-hidden="true" tabindex="-1"></a>ind <span class="ot">=</span> <span class="fu">sample</span>(<span class="fu">length</span>(y),N)</span>
<span id="cb657-4"><a href="basic-machine-learning.html#cb657-4" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">=</span> y[ind]</span>
<span id="cb657-5"><a href="basic-machine-learning.html#cb657-5" aria-hidden="true" tabindex="-1"></a>X <span class="ot">=</span> x[ind]</span></code></pre></div>
<p>Use loess to estimate <span class="math inline">\(f(x) = E(Y|X=x)\)</span> using the default parameters. What is the predicted <span class="math inline">\(f(168)\)</span>?</p>
<hr />
<div class="sourceCode" id="cb658"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb658-1"><a href="basic-machine-learning.html#cb658-1" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">loess</span>(Y<span class="sc">~</span>X)</span>
<span id="cb658-2"><a href="basic-machine-learning.html#cb658-2" aria-hidden="true" tabindex="-1"></a>newx <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(X),<span class="fu">max</span>(X),<span class="at">len=</span><span class="dv">45</span>)</span>
<span id="cb658-3"><a href="basic-machine-learning.html#cb658-3" aria-hidden="true" tabindex="-1"></a>hat <span class="ot">&lt;-</span> <span class="fu">predict</span>(fit, <span class="at">newdata=</span><span class="fu">data.frame</span>(<span class="at">X=</span>newx))</span>
<span id="cb658-4"><a href="basic-machine-learning.html#cb658-4" aria-hidden="true" tabindex="-1"></a><span class="fu">mypar</span>()</span>
<span id="cb658-5"><a href="basic-machine-learning.html#cb658-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(X,Y)</span>
<span id="cb658-6"><a href="basic-machine-learning.html#cb658-6" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(hat) <span class="ot">&lt;-</span> <span class="fu">round</span>(newx,<span class="dv">1</span>)</span>
<span id="cb658-7"><a href="basic-machine-learning.html#cb658-7" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(newx,hat)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-360-1.png" width="672" /></p>
<div class="sourceCode" id="cb659"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb659-1"><a href="basic-machine-learning.html#cb659-1" aria-hidden="true" tabindex="-1"></a>hat[<span class="st">&#39;168&#39;</span>]</span></code></pre></div>
<pre><code>##       168 
## 0.5480233</code></pre>
</div>
<div id="question-2-30" class="section level3 unnumbered">
<h3>Question 2</h3>
<p>The loess estimate above is a random variable. We can compute standard errors for it. Here we use Monte Carlo to demonstrate that it is a random variable. Use Monte Carlo simulation to estimate the standard error of your estimate of <span class="math inline">\(f(168)\)</span>.</p>
<p>Set the seed to 5, <code>set.seed(5)</code> and perform 10,000 simulations and report the SE of the loess based estimate.</p>
<hr />
<div class="sourceCode" id="cb661"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb661-1"><a href="basic-machine-learning.html#cb661-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">5</span>)</span>
<span id="cb661-2"><a href="basic-machine-learning.html#cb661-2" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb661-3"><a href="basic-machine-learning.html#cb661-3" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">250</span></span>
<span id="cb661-4"><a href="basic-machine-learning.html#cb661-4" aria-hidden="true" tabindex="-1"></a>newx <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(X),<span class="fu">max</span>(X),<span class="at">len=</span><span class="dv">45</span>)</span>
<span id="cb661-5"><a href="basic-machine-learning.html#cb661-5" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">replicate</span>(B, {</span>
<span id="cb661-6"><a href="basic-machine-learning.html#cb661-6" aria-hidden="true" tabindex="-1"></a>  ind <span class="ot">=</span> <span class="fu">sample</span>(<span class="fu">length</span>(y),N)</span>
<span id="cb661-7"><a href="basic-machine-learning.html#cb661-7" aria-hidden="true" tabindex="-1"></a>  Y <span class="ot">=</span> y[ind]</span>
<span id="cb661-8"><a href="basic-machine-learning.html#cb661-8" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">=</span> x[ind]</span>
<span id="cb661-9"><a href="basic-machine-learning.html#cb661-9" aria-hidden="true" tabindex="-1"></a>  fit <span class="ot">&lt;-</span> <span class="fu">loess</span>(Y<span class="sc">~</span>X)</span>
<span id="cb661-10"><a href="basic-machine-learning.html#cb661-10" aria-hidden="true" tabindex="-1"></a>  hat <span class="ot">&lt;-</span> <span class="fu">predict</span>(fit, <span class="at">newdata=</span><span class="fu">data.frame</span>(<span class="at">X=</span>newx))</span>
<span id="cb661-11"><a href="basic-machine-learning.html#cb661-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(hat) <span class="ot">&lt;-</span> <span class="fu">round</span>(newx,<span class="dv">1</span>)</span>
<span id="cb661-12"><a href="basic-machine-learning.html#cb661-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(hat[<span class="st">&#39;168&#39;</span>])</span>
<span id="cb661-13"><a href="basic-machine-learning.html#cb661-13" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb661-14"><a href="basic-machine-learning.html#cb661-14" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(res) <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb661-15"><a href="basic-machine-learning.html#cb661-15" aria-hidden="true" tabindex="-1"></a><span class="fu">popsd</span>(res)</span></code></pre></div>
<pre><code>## [1] 0.05618195</code></pre>
</div>
</div>
<div id="exercises-31" class="section level2 unnumbered">
<h2>9.11 Exercises</h2>
<p>Load the following dataset:</p>
<div class="sourceCode" id="cb663"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb663-1"><a href="basic-machine-learning.html#cb663-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(GSE5859Subset)</span>
<span id="cb663-2"><a href="basic-machine-learning.html#cb663-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(GSE5859Subset)</span></code></pre></div>
<p>And define the outcome and predictors. To make the problem more dificult, we will only consider autosomal genes:</p>
<div class="sourceCode" id="cb664"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb664-1"><a href="basic-machine-learning.html#cb664-1" aria-hidden="true" tabindex="-1"></a>y <span class="ot">=</span> <span class="fu">factor</span>(sampleInfo<span class="sc">$</span>group)</span>
<span id="cb664-2"><a href="basic-machine-learning.html#cb664-2" aria-hidden="true" tabindex="-1"></a>X <span class="ot">=</span> <span class="fu">t</span>(geneExpression)</span>
<span id="cb664-3"><a href="basic-machine-learning.html#cb664-3" aria-hidden="true" tabindex="-1"></a>out <span class="ot">=</span> <span class="fu">which</span>(geneAnnotation<span class="sc">$</span>CHR<span class="sc">%in%</span><span class="fu">c</span>(<span class="st">&quot;chrX&quot;</span>,<span class="st">&quot;chrY&quot;</span>))</span>
<span id="cb664-4"><a href="basic-machine-learning.html#cb664-4" aria-hidden="true" tabindex="-1"></a>X <span class="ot">=</span> X[,<span class="sc">-</span>out]</span></code></pre></div>
<div id="question-1-33" class="section level3 unnumbered">
<h3>Question 1</h3>
<p>Use the <code>createFold</code> function in the <code>caret</code> package, set the seed to 1 <code>set.seed(1)</code> and create 10 folds of <code>y</code>. What are the 2nd entry in the fold 3?</p>
<hr />
<div class="sourceCode" id="cb665"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb665-1"><a href="basic-machine-learning.html#cb665-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)</span>
<span id="cb665-2"><a href="basic-machine-learning.html#cb665-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb665-3"><a href="basic-machine-learning.html#cb665-3" aria-hidden="true" tabindex="-1"></a>idx <span class="ot">&lt;-</span> <span class="fu">createFolds</span>(y, <span class="at">k =</span> <span class="dv">10</span>)</span>
<span id="cb665-4"><a href="basic-machine-learning.html#cb665-4" aria-hidden="true" tabindex="-1"></a>idx[[<span class="dv">3</span>]][<span class="dv">2</span>]</span></code></pre></div>
<pre><code>## [1] 15</code></pre>
</div>
<div id="question-2-31" class="section level3 unnumbered">
<h3>Question 2</h3>
<p>We are going to use kNN. We are going to consider a smaller set of predictors by using filtering gene using t-tests. Specifically, we will perform a t-test and select the <span class="math inline">\(m\)</span> genes with the smallest p-values.</p>
<p>Let m = 8 and k = 5 and train kNN by leaving out the second fold <code>idx[[2]]</code>. How many mistakes do we make on the test set? Remember it is indispensable that you perform
the t-test on the training data. <strong>Use all 10 folds, keep k = 5. Hint: be careful about indexing.</strong></p>
<hr />
<div class="sourceCode" id="cb667"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb667-1"><a href="basic-machine-learning.html#cb667-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">8</span> <span class="co"># number of genes</span></span>
<span id="cb667-2"><a href="basic-machine-learning.html#cb667-2" aria-hidden="true" tabindex="-1"></a>pvals <span class="ot">&lt;-</span> <span class="fu">rowttests</span>(<span class="fu">t</span>(X[<span class="sc">-</span>idx[[<span class="dv">2</span>]],]),y[<span class="sc">-</span>idx[[<span class="dv">2</span>]]])<span class="sc">$</span>p.value</span>
<span id="cb667-3"><a href="basic-machine-learning.html#cb667-3" aria-hidden="true" tabindex="-1"></a>ind <span class="ot">&lt;-</span> <span class="fu">order</span>(pvals)[<span class="dv">1</span><span class="sc">:</span>m]</span>
<span id="cb667-4"><a href="basic-machine-learning.html#cb667-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb667-5"><a href="basic-machine-learning.html#cb667-5" aria-hidden="true" tabindex="-1"></a>pred <span class="ot">&lt;-</span> <span class="fu">knn</span>(<span class="at">train =</span> X[<span class="sc">-</span>idx[[<span class="dv">2</span>]],ind],</span>
<span id="cb667-6"><a href="basic-machine-learning.html#cb667-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">test =</span> X[idx[[<span class="dv">2</span>]],ind],</span>
<span id="cb667-7"><a href="basic-machine-learning.html#cb667-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">cl =</span> y[<span class="sc">-</span>idx[[<span class="dv">2</span>]]], <span class="at">k =</span> <span class="dv">5</span>)</span>
<span id="cb667-8"><a href="basic-machine-learning.html#cb667-8" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(pred <span class="sc">!=</span> y[idx[[<span class="dv">2</span>]]])</span></code></pre></div>
<pre><code>## [1] 1</code></pre>
<p>When performing <code>rowttests</code> it is important to exclude test data. Indexing becomes quite tricky because you need to separate training and test data.</p>
</div>
<div id="question-3-27" class="section level3 unnumbered">
<h3>Question 3</h3>
<p>Now run through all 5 folds. What is our error rate <strong>(total number of errors / total predictions)</strong>?</p>
<hr />
<div class="sourceCode" id="cb669"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb669-1"><a href="basic-machine-learning.html#cb669-1" aria-hidden="true" tabindex="-1"></a>n_fold <span class="ot">&lt;-</span> <span class="fu">length</span>(idx)</span>
<span id="cb669-2"><a href="basic-machine-learning.html#cb669-2" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">&#39;double&#39;</span>, n_fold)</span>
<span id="cb669-3"><a href="basic-machine-learning.html#cb669-3" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">8</span></span>
<span id="cb669-4"><a href="basic-machine-learning.html#cb669-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq</span>(n_fold)) {</span>
<span id="cb669-5"><a href="basic-machine-learning.html#cb669-5" aria-hidden="true" tabindex="-1"></a>  pvals <span class="ot">&lt;-</span> <span class="fu">rowttests</span>(<span class="fu">t</span>(X[<span class="sc">-</span>idx[[i]],]),y[<span class="sc">-</span>idx[[i]]])<span class="sc">$</span>p.value</span>
<span id="cb669-6"><a href="basic-machine-learning.html#cb669-6" aria-hidden="true" tabindex="-1"></a>  ind <span class="ot">&lt;-</span> <span class="fu">order</span>(pvals)[<span class="dv">1</span><span class="sc">:</span>m]</span>
<span id="cb669-7"><a href="basic-machine-learning.html#cb669-7" aria-hidden="true" tabindex="-1"></a>  pred <span class="ot">&lt;-</span> <span class="fu">knn</span>(<span class="at">train =</span> X[<span class="sc">-</span>idx[[i]],ind],</span>
<span id="cb669-8"><a href="basic-machine-learning.html#cb669-8" aria-hidden="true" tabindex="-1"></a>              <span class="at">test =</span> X[idx[[i]],ind],</span>
<span id="cb669-9"><a href="basic-machine-learning.html#cb669-9" aria-hidden="true" tabindex="-1"></a>              <span class="at">cl =</span> y[<span class="sc">-</span>idx[[i]]], <span class="at">k =</span> <span class="dv">5</span>)</span>
<span id="cb669-10"><a href="basic-machine-learning.html#cb669-10" aria-hidden="true" tabindex="-1"></a>  res[[i]] <span class="ot">&lt;-</span> <span class="fu">sum</span>(pred <span class="sc">!=</span> y[idx[[i]]])</span>
<span id="cb669-11"><a href="basic-machine-learning.html#cb669-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb669-12"><a href="basic-machine-learning.html#cb669-12" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(res)<span class="sc">/</span><span class="fu">length</span>(y)</span></code></pre></div>
<pre><code>## [1] 0.375</code></pre>
</div>
<div id="question-4-24" class="section level3 unnumbered">
<h3>Question 4</h3>
<p>Now we are going to select the best values of k and m. Use the <code>expand.grid</code> function to try out the following values:</p>
<div class="sourceCode" id="cb671"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb671-1"><a href="basic-machine-learning.html#cb671-1" aria-hidden="true" tabindex="-1"></a>ms<span class="ot">=</span><span class="dv">2</span><span class="sc">^</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">11</span>)</span>
<span id="cb671-2"><a href="basic-machine-learning.html#cb671-2" aria-hidden="true" tabindex="-1"></a>ks<span class="ot">=</span><span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">9</span>,<span class="dv">2</span>)</span>
<span id="cb671-3"><a href="basic-machine-learning.html#cb671-3" aria-hidden="true" tabindex="-1"></a>params <span class="ot">=</span> <span class="fu">expand.grid</span>(<span class="at">k=</span>ks,<span class="at">m=</span>ms)</span></code></pre></div>
<p>Now use <code>sapply</code> or a <code>for</code>-loop to obtain error rates for each of these pairs of parameters. Which pair of parameters minimizes the error rate? <strong>Like previously, use the same p-values that you selected from the training data alone, and loop over 10 folds.</strong></p>
<div class="sourceCode" id="cb672"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb672-1"><a href="basic-machine-learning.html#cb672-1" aria-hidden="true" tabindex="-1"></a>ms <span class="ot">=</span> <span class="dv">2</span><span class="sc">^</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">11</span>)</span>
<span id="cb672-2"><a href="basic-machine-learning.html#cb672-2" aria-hidden="true" tabindex="-1"></a>ks <span class="ot">=</span> <span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">9</span>,<span class="dv">2</span>)</span>
<span id="cb672-3"><a href="basic-machine-learning.html#cb672-3" aria-hidden="true" tabindex="-1"></a>params <span class="ot">=</span> <span class="fu">expand.grid</span>(<span class="at">k=</span>ks, <span class="at">m=</span>ms)</span>
<span id="cb672-4"><a href="basic-machine-learning.html#cb672-4" aria-hidden="true" tabindex="-1"></a>n_fold <span class="ot">&lt;-</span> <span class="fu">length</span>(idx)</span>
<span id="cb672-5"><a href="basic-machine-learning.html#cb672-5" aria-hidden="true" tabindex="-1"></a>error_rate_avg <span class="ot">=</span> <span class="fu">vector</span>(<span class="st">&#39;double&#39;</span>,<span class="fu">nrow</span>(params))</span>
<span id="cb672-6"><a href="basic-machine-learning.html#cb672-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="fu">seq</span>(<span class="fu">nrow</span>(params))) {</span>
<span id="cb672-7"><a href="basic-machine-learning.html#cb672-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq</span>(n_fold)) {</span>
<span id="cb672-8"><a href="basic-machine-learning.html#cb672-8" aria-hidden="true" tabindex="-1"></a>    pvals <span class="ot">&lt;-</span> <span class="fu">rowttests</span>(<span class="fu">t</span>(X[<span class="sc">-</span>idx[[i]],]),y[<span class="sc">-</span>idx[[i]]])<span class="sc">$</span>p.value</span>
<span id="cb672-9"><a href="basic-machine-learning.html#cb672-9" aria-hidden="true" tabindex="-1"></a>    ind <span class="ot">&lt;-</span> <span class="fu">order</span>(pvals)[<span class="dv">1</span><span class="sc">:</span>params[j,][[<span class="dv">2</span>]]]</span>
<span id="cb672-10"><a href="basic-machine-learning.html#cb672-10" aria-hidden="true" tabindex="-1"></a>    pred <span class="ot">&lt;-</span> <span class="fu">knn</span>(<span class="at">train =</span> X[<span class="sc">-</span>idx[[i]],ind],</span>
<span id="cb672-11"><a href="basic-machine-learning.html#cb672-11" aria-hidden="true" tabindex="-1"></a>                <span class="at">test =</span> X[idx[[i]],ind],</span>
<span id="cb672-12"><a href="basic-machine-learning.html#cb672-12" aria-hidden="true" tabindex="-1"></a>                <span class="at">cl =</span> y[<span class="sc">-</span>idx[[i]]], <span class="at">k =</span> params[j,][[<span class="dv">1</span>]])</span>
<span id="cb672-13"><a href="basic-machine-learning.html#cb672-13" aria-hidden="true" tabindex="-1"></a>    res[[i]] <span class="ot">&lt;-</span> <span class="fu">sum</span>(pred <span class="sc">!=</span> y[idx[[i]]])</span>
<span id="cb672-14"><a href="basic-machine-learning.html#cb672-14" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb672-15"><a href="basic-machine-learning.html#cb672-15" aria-hidden="true" tabindex="-1"></a>  error_rate_avg[[j]] <span class="ot">&lt;-</span> <span class="fu">sum</span>(res)<span class="sc">/</span><span class="fu">length</span>(y)</span>
<span id="cb672-16"><a href="basic-machine-learning.html#cb672-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb672-17"><a href="basic-machine-learning.html#cb672-17" aria-hidden="true" tabindex="-1"></a>ind <span class="ot">&lt;-</span> <span class="fu">which</span>(error_rate_avg <span class="sc">==</span> <span class="fu">min</span>(error_rate_avg))</span>
<span id="cb672-18"><a href="basic-machine-learning.html#cb672-18" aria-hidden="true" tabindex="-1"></a>params[ind,] <span class="co"># answer</span></span></code></pre></div>
<pre><code>##    k    m
## 47 3 1024</code></pre>
<div class="sourceCode" id="cb674"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb674-1"><a href="basic-machine-learning.html#cb674-1" aria-hidden="true" tabindex="-1"></a><span class="fu">min</span>(error_rate_avg) <span class="co"># minimum error rate</span></span></code></pre></div>
<pre><code>## [1] 0.2083333</code></pre>
</div>
<div id="question-5-17" class="section level3 unnumbered">
<h3>Question 5</h3>
<p>Repeat <strong>Question 4</strong>, but now perform the t-test filtering before the cross validation. Note how this biases the entire result and gives us much lower estimated error rates. <strong>What is the minimum error rate?</strong></p>
<hr />
<div class="sourceCode" id="cb676"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb676-1"><a href="basic-machine-learning.html#cb676-1" aria-hidden="true" tabindex="-1"></a>ms <span class="ot">=</span> <span class="dv">2</span><span class="sc">^</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">11</span>)</span>
<span id="cb676-2"><a href="basic-machine-learning.html#cb676-2" aria-hidden="true" tabindex="-1"></a>ks <span class="ot">=</span> <span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">9</span>,<span class="dv">2</span>)</span>
<span id="cb676-3"><a href="basic-machine-learning.html#cb676-3" aria-hidden="true" tabindex="-1"></a>params <span class="ot">=</span> <span class="fu">expand.grid</span>(<span class="at">k=</span>ks, <span class="at">m=</span>ms)</span>
<span id="cb676-4"><a href="basic-machine-learning.html#cb676-4" aria-hidden="true" tabindex="-1"></a>n_fold <span class="ot">&lt;-</span> <span class="fu">length</span>(idx)</span>
<span id="cb676-5"><a href="basic-machine-learning.html#cb676-5" aria-hidden="true" tabindex="-1"></a>error_rate_avg <span class="ot">=</span> <span class="fu">vector</span>(<span class="st">&#39;double&#39;</span>,<span class="fu">nrow</span>(params))</span>
<span id="cb676-6"><a href="basic-machine-learning.html#cb676-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="fu">seq</span>(<span class="fu">nrow</span>(params))) {</span>
<span id="cb676-7"><a href="basic-machine-learning.html#cb676-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq</span>(n_fold)) {</span>
<span id="cb676-8"><a href="basic-machine-learning.html#cb676-8" aria-hidden="true" tabindex="-1"></a>    pvals <span class="ot">&lt;-</span> <span class="fu">rowttests</span>(<span class="fu">t</span>(X),y)<span class="sc">$</span>p.value</span>
<span id="cb676-9"><a href="basic-machine-learning.html#cb676-9" aria-hidden="true" tabindex="-1"></a>    ind <span class="ot">&lt;-</span> <span class="fu">order</span>(pvals)[<span class="dv">1</span><span class="sc">:</span>params[j,][[<span class="dv">2</span>]]]</span>
<span id="cb676-10"><a href="basic-machine-learning.html#cb676-10" aria-hidden="true" tabindex="-1"></a>    pred <span class="ot">&lt;-</span> <span class="fu">knn</span>(<span class="at">train =</span> X[<span class="sc">-</span>idx[[i]],ind],</span>
<span id="cb676-11"><a href="basic-machine-learning.html#cb676-11" aria-hidden="true" tabindex="-1"></a>                <span class="at">test =</span> X[idx[[i]],ind],</span>
<span id="cb676-12"><a href="basic-machine-learning.html#cb676-12" aria-hidden="true" tabindex="-1"></a>                <span class="at">cl =</span> y[<span class="sc">-</span>idx[[i]]], <span class="at">k =</span> params[j,][[<span class="dv">1</span>]])</span>
<span id="cb676-13"><a href="basic-machine-learning.html#cb676-13" aria-hidden="true" tabindex="-1"></a>    res[[i]] <span class="ot">&lt;-</span> <span class="fu">sum</span>(pred <span class="sc">!=</span> y[idx[[i]]])</span>
<span id="cb676-14"><a href="basic-machine-learning.html#cb676-14" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb676-15"><a href="basic-machine-learning.html#cb676-15" aria-hidden="true" tabindex="-1"></a>  error_rate_avg[[j]] <span class="ot">&lt;-</span> <span class="fu">sum</span>(res)<span class="sc">/</span><span class="fu">length</span>(y)</span>
<span id="cb676-16"><a href="basic-machine-learning.html#cb676-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb676-17"><a href="basic-machine-learning.html#cb676-17" aria-hidden="true" tabindex="-1"></a><span class="fu">min</span>(error_rate_avg) <span class="co"># minimum error rate</span></span></code></pre></div>
<pre><code>## [1] 0.08333333</code></pre>
<div class="sourceCode" id="cb678"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb678-1"><a href="basic-machine-learning.html#cb678-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(error_rate_avg) <span class="co"># mean error rate</span></span></code></pre></div>
<pre><code>## [1] 0.1833333</code></pre>
<p>The error rate is much lower than the one in <strong>Question 4</strong> because we did not filter out p values from the test data in this case. This is not a correct practice. The practice shown in <strong>Question 4</strong> is correct.</p>
</div>
<div id="question-6-14" class="section level3 unnumbered">
<h3>Question 6</h3>
<p>Repeat <strong>Question 3</strong>, but now, instead of <code>sampleInfo$group</code>, use</p>
<div class="sourceCode" id="cb680"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb680-1"><a href="basic-machine-learning.html#cb680-1" aria-hidden="true" tabindex="-1"></a>y <span class="ot">=</span> <span class="fu">factor</span>(<span class="fu">as.numeric</span>(<span class="fu">format</span>( sampleInfo<span class="sc">$</span>date, <span class="st">&quot;%m&quot;</span>)<span class="sc">==</span><span class="st">&quot;06&quot;</span>))</span></code></pre></div>
<p>What is the minimum error rate now?</p>
<hr />
<div class="sourceCode" id="cb681"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb681-1"><a href="basic-machine-learning.html#cb681-1" aria-hidden="true" tabindex="-1"></a>ms <span class="ot">=</span> <span class="dv">2</span><span class="sc">^</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">11</span>)</span>
<span id="cb681-2"><a href="basic-machine-learning.html#cb681-2" aria-hidden="true" tabindex="-1"></a>ks <span class="ot">=</span> <span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">9</span>,<span class="dv">2</span>)</span>
<span id="cb681-3"><a href="basic-machine-learning.html#cb681-3" aria-hidden="true" tabindex="-1"></a>params <span class="ot">=</span> <span class="fu">expand.grid</span>(<span class="at">k=</span>ks, <span class="at">m=</span>ms)</span>
<span id="cb681-4"><a href="basic-machine-learning.html#cb681-4" aria-hidden="true" tabindex="-1"></a>n_fold <span class="ot">&lt;-</span> <span class="fu">length</span>(idx)</span>
<span id="cb681-5"><a href="basic-machine-learning.html#cb681-5" aria-hidden="true" tabindex="-1"></a>error_rate_avg <span class="ot">=</span> <span class="fu">vector</span>(<span class="st">&#39;double&#39;</span>,<span class="fu">nrow</span>(params))</span>
<span id="cb681-6"><a href="basic-machine-learning.html#cb681-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="fu">seq</span>(<span class="fu">nrow</span>(params))) {</span>
<span id="cb681-7"><a href="basic-machine-learning.html#cb681-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq</span>(n_fold)) {</span>
<span id="cb681-8"><a href="basic-machine-learning.html#cb681-8" aria-hidden="true" tabindex="-1"></a>    pvals <span class="ot">&lt;-</span> <span class="fu">rowttests</span>(<span class="fu">t</span>(X[<span class="sc">-</span>idx[[i]],]),y[<span class="sc">-</span>idx[[i]]])<span class="sc">$</span>p.value</span>
<span id="cb681-9"><a href="basic-machine-learning.html#cb681-9" aria-hidden="true" tabindex="-1"></a>    ind <span class="ot">&lt;-</span> <span class="fu">order</span>(pvals)[<span class="dv">1</span><span class="sc">:</span>params[j,][[<span class="dv">2</span>]]]</span>
<span id="cb681-10"><a href="basic-machine-learning.html#cb681-10" aria-hidden="true" tabindex="-1"></a>    pred <span class="ot">&lt;-</span> <span class="fu">knn</span>(<span class="at">train =</span> X[<span class="sc">-</span>idx[[i]],ind],</span>
<span id="cb681-11"><a href="basic-machine-learning.html#cb681-11" aria-hidden="true" tabindex="-1"></a>                <span class="at">test =</span> X[idx[[i]],ind],</span>
<span id="cb681-12"><a href="basic-machine-learning.html#cb681-12" aria-hidden="true" tabindex="-1"></a>                <span class="at">cl =</span> y[<span class="sc">-</span>idx[[i]]], <span class="at">k =</span> params[j,][[<span class="dv">1</span>]])</span>
<span id="cb681-13"><a href="basic-machine-learning.html#cb681-13" aria-hidden="true" tabindex="-1"></a>    res[[i]] <span class="ot">&lt;-</span> <span class="fu">sum</span>(pred <span class="sc">!=</span> y[idx[[i]]])</span>
<span id="cb681-14"><a href="basic-machine-learning.html#cb681-14" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb681-15"><a href="basic-machine-learning.html#cb681-15" aria-hidden="true" tabindex="-1"></a>  error_rate_avg[[j]] <span class="ot">&lt;-</span> <span class="fu">sum</span>(res)<span class="sc">/</span><span class="fu">length</span>(y)</span>
<span id="cb681-16"><a href="basic-machine-learning.html#cb681-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb681-17"><a href="basic-machine-learning.html#cb681-17" aria-hidden="true" tabindex="-1"></a><span class="fu">min</span>(error_rate_avg) <span class="co"># minimum error rate</span></span></code></pre></div>
<pre><code>## [1] 0</code></pre>
<div class="sourceCode" id="cb683"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb683-1"><a href="basic-machine-learning.html#cb683-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(error_rate_avg) <span class="co"># mean error rate</span></span></code></pre></div>
<pre><code>## [1] 0.06060606</code></pre>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="distance-and-dimension-reduction.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="batch-effects.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/smin95/da4ls_exercise_solution/edit/master/9-ml.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/smin95/da4ls_exercise_solution/blob/master/9-ml.Rmd",
"text": null
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
